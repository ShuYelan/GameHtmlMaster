<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ±äº¬ãƒŸãƒƒãƒ‰ãƒŠã‚¤ãƒˆæ®ºäººäº‹ä»¶</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&family=Noto+Serif+JP:wght@400;600&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-dark: #0a0e27;
            --secondary-dark: #1a1f3a;
            --accent-gold: #d4af37;
            --accent-red: #8b0000;
            --text-light: #e8e8e8;
            --text-dim: #a0a0a0;
            --border-color: #2a2f4a;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--secondary-dark) 100%);
            color: var(--text-light);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .background-pattern {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image:
                repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(255,255,255,.03) 2px, rgba(255,255,255,.03) 4px),
                repeating-linear-gradient(90deg, transparent, transparent 2px, rgba(255,255,255,.03) 2px, rgba(255,255,255,.03) 4px);
            pointer-events: none;
            z-index: 1;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 2;
        }

        header {
            text-align: center;
            padding: 40px 20px;
            border-bottom: 2px solid var(--accent-gold);
            margin-bottom: 40px;
            background: rgba(26, 31, 58, 0.6);
            backdrop-filter: blur(10px);
            border-radius: 10px;
        }

        h1 {
            font-family: 'Noto Serif JP', serif;
            font-size: 3em;
            font-weight: 600;
            color: var(--accent-gold);
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            letter-spacing: 0.1em;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.1em;
            color: var(--text-dim);
            letter-spacing: 0.2em;
        }

        .intro-screen, .game-screen {
            background: rgba(26, 31, 58, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 40px;
            border: 1px solid var(--border-color);
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }

        .intro-content {
            max-width: 800px;
            margin: 0 auto;
            line-height: 2;
        }

        .intro-content p {
            margin-bottom: 20px;
            font-size: 1.1em;
        }

        .victim-info {
            background: rgba(139, 0, 0, 0.2);
            border-left: 4px solid var(--accent-red);
            padding: 20px;
            margin: 30px 0;
            border-radius: 5px;
        }

        .start-btn {
            display: block;
            margin: 40px auto 0;
            padding: 15px 60px;
            background: linear-gradient(135deg, var(--accent-gold) 0%, #b8941f 100%);
            color: var(--primary-dark);
            border: none;
            border-radius: 50px;
            font-size: 1.2em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            font-family: 'Noto Sans JP', sans-serif;
        }

        .start-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(212, 175, 55, 0.4);
        }

        .game-screen {
            display: none;
        }

        .game-layout {
            display: grid;
            grid-template-columns: 300px 1fr 350px;
            gap: 20px;
            margin-top: 20px;
        }

        .suspects-panel {
            background: rgba(10, 14, 39, 0.6);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid var(--border-color);
        }

        .suspect-card {
            background: rgba(26, 31, 58, 0.8);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .suspect-card:hover {
            border-color: var(--accent-gold);
            transform: translateX(5px);
        }

        .suspect-card.active {
            border-color: var(--accent-gold);
            background: rgba(212, 175, 55, 0.1);
        }

        .suspect-name {
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--accent-gold);
        }

        .suspect-role {
            font-size: 0.9em;
            color: var(--text-dim);
        }

        .main-panel {
            background: rgba(10, 14, 39, 0.6);
            border-radius: 10px;
            padding: 30px;
            border: 1px solid var(--border-color);
        }

        .evidence-panel {
            background: rgba(10, 14, 39, 0.6);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid var(--border-color);
            max-height: 800px;
            overflow-y: auto;
        }

        .panel-title {
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--accent-gold);
            color: var(--accent-gold);
        }

        .suspect-detail {
            display: none;
        }

        .suspect-detail.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .detail-section {
            margin-bottom: 30px;
        }

        .detail-section h3 {
            color: var(--accent-gold);
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .detail-section p, .detail-section li {
            line-height: 1.8;
            margin-bottom: 10px;
        }

        .alibi-box {
            background: rgba(26, 31, 58, 0.6);
            border-left: 3px solid var(--accent-gold);
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .question-btn {
            background: rgba(212, 175, 55, 0.2);
            border: 1px solid var(--accent-gold);
            color: var(--text-light);
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
            font-family: 'Noto Sans JP', sans-serif;
        }

        .question-btn:hover {
            background: rgba(212, 175, 55, 0.3);
        }

        .question-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .answer-box {
            background: rgba(26, 31, 58, 0.8);
            border-left: 3px solid var(--accent-red);
            padding: 15px;
            margin-top: 10px;
            border-radius: 5px;
            display: none;
        }

        .answer-box.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .evidence-item {
            background: rgba(26, 31, 58, 0.8);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .evidence-item.new {
            border-color: var(--accent-gold);
            animation: pulse 2s ease;
        }

        @keyframes pulse {
            0%, 100% { border-color: var(--accent-gold); }
            50% { border-color: var(--accent-red); }
        }

        .evidence-title {
            color: var(--accent-gold);
            font-weight: 600;
            margin-bottom: 10px;
        }

        .accusation-panel {
            background: rgba(139, 0, 0, 0.2);
            border: 2px solid var(--accent-red);
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
        }

        .accusation-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, var(--accent-red) 0%, #660000 100%);
            color: var(--text-light);
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Noto Sans JP', sans-serif;
        }

        .accusation-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139, 0, 0, 0.4);
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: linear-gradient(135deg, var(--secondary-dark) 0%, var(--primary-dark) 100%);
            margin: 5% auto;
            padding: 40px;
            border: 2px solid var(--accent-gold);
            border-radius: 15px;
            width: 80%;
            max-width: 700px;
            box-shadow: 0 10px 50px rgba(0,0,0,0.5);
        }

        .close {
            color: var(--text-dim);
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close:hover {
            color: var(--accent-gold);
        }

        .suspect-option {
            background: rgba(26, 31, 58, 0.8);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .suspect-option:hover {
            border-color: var(--accent-gold);
            transform: translateX(5px);
        }

        .suspect-option.selected {
            border-color: var(--accent-red);
            background: rgba(139, 0, 0, 0.2);
        }

        .submit-accusation {
            margin-top: 20px;
            padding: 15px 40px;
            background: linear-gradient(135deg, var(--accent-gold) 0%, #b8941f 100%);
            color: var(--primary-dark);
            border: none;
            border-radius: 50px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Noto Sans JP', sans-serif;
        }

        .submit-accusation:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(212, 175, 55, 0.4);
        }

        .result-screen {
            display: none;
            text-align: center;
        }

        .result-title {
            font-family: 'Noto Serif JP', serif;
            font-size: 2.5em;
            margin-bottom: 30px;
        }

        .result-title.success {
            color: var(--accent-gold);
        }

        .result-title.failure {
            color: var(--accent-red);
        }

        .explanation {
            background: rgba(26, 31, 58, 0.8);
            border-radius: 10px;
            padding: 30px;
            margin: 30px 0;
            text-align: left;
            line-height: 2;
        }

        .explanation h3 {
            color: var(--accent-gold);
            margin: 20px 0 10px 0;
        }

        .timeline {
            background: rgba(10, 14, 39, 0.6);
            border-left: 3px solid var(--accent-gold);
            padding: 20px;
            margin: 20px 0;
        }

        .timeline-item {
            margin-bottom: 15px;
            padding-left: 20px;
            border-left: 2px solid var(--text-dim);
        }

        .scrollbar::-webkit-scrollbar {
            width: 8px;
        }

        .scrollbar::-webkit-scrollbar-track {
            background: rgba(26, 31, 58, 0.5);
            border-radius: 4px;
        }

        .scrollbar::-webkit-scrollbar-thumb {
            background: var(--accent-gold);
            border-radius: 4px;
        }

        .scrollbar::-webkit-scrollbar-thumb:hover {
            background: #b8941f;
        }

        /* BGM Control Panel */
        .bgm-control {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: rgba(26, 31, 58, 0.95);
            backdrop-filter: blur(10px);
            border: 2px solid var(--border-color);
            border-radius: 15px;
            padding: 15px;
            z-index: 999;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
        }

        .bgm-control.collapsed {
            min-width: auto;
        }

        .bgm-control.expanded {
            min-width: 280px;
        }

        .bgm-control:hover {
            border-color: var(--accent-gold);
        }

        .bgm-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            user-select: none;
        }

        .bgm-title {
            font-size: 0.9em;
            color: var(--accent-gold);
            font-weight: 600;
            letter-spacing: 0.05em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .bgm-toggle-icon {
            font-size: 0.8em;
            transition: transform 0.3s ease;
        }

        .bgm-control.expanded .bgm-toggle-icon {
            transform: rotate(180deg);
        }

        .bgm-now-playing {
            font-size: 0.85em;
            color: var(--text-dim);
            margin-top: 10px;
            font-style: italic;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .bgm-control.collapsed .bgm-now-playing {
            max-height: 0;
            margin-top: 0;
            opacity: 0;
        }

        .bgm-controls {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--border-color);
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .bgm-control.collapsed .bgm-controls {
            max-height: 0;
            margin-top: 0;
            padding-top: 0;
            opacity: 0;
        }

        .bgm-mute-btn {
            background: rgba(212, 175, 55, 0.2);
            border: 1px solid var(--accent-gold);
            color: var(--accent-gold);
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Noto Sans JP', sans-serif;
            font-size: 0.9em;
            white-space: nowrap;
        }

        .bgm-mute-btn:hover {
            background: rgba(212, 175, 55, 0.3);
            transform: translateY(-1px);
        }

        .bgm-mute-btn.muted {
            background: rgba(139, 0, 0, 0.3);
            border-color: var(--accent-red);
            color: var(--accent-red);
        }

        .volume-control {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .volume-slider {
            flex: 1;
            -webkit-appearance: none;
            appearance: none;
            height: 6px;
            background: rgba(42, 47, 74, 0.8);
            border-radius: 3px;
            outline: none;
        }

        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            background: var(--accent-gold);
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .volume-slider::-webkit-slider-thumb:hover {
            background: #b8941f;
            transform: scale(1.2);
        }

        .volume-slider::-moz-range-thumb {
            width: 16px;
            height: 16px;
            background: var(--accent-gold);
            border-radius: 50%;
            cursor: pointer;
            border: none;
            transition: all 0.3s ease;
        }

        .volume-slider::-moz-range-thumb:hover {
            background: #b8941f;
            transform: scale(1.2);
        }

        .volume-label {
            font-size: 0.85em;
            color: var(--text-dim);
            min-width: 35px;
            text-align: right;
        }

        @media (max-width: 1200px) {
            .game-layout {
                grid-template-columns: 1fr;
            }

            h1 {
                font-size: 2em;
            }

            .bgm-control {
                bottom: 15px;
                right: 15px;
                padding: 12px;
            }

            .bgm-control.expanded {
                min-width: 250px;
            }
        }

        @media (max-width: 600px) {
            .bgm-control.expanded {
                left: 15px;
                right: 15px;
                min-width: auto;
            }
        }
    </style>
</head>
<body>
    <!-- Audio Elements -->
    <audio id="defaultBGM" loop>
        <source src="fukakai-nazo_Loopã®ã‚³ãƒ”ãƒ¼.ogg" type="audio/ogg">
    </audio>
    <audio id="accusationBGM">
        <source src="resolution-orã®ã‚³ãƒ”ãƒ¼.mp3" type="audio/mpeg">
    </audio>
    <audio id="clearBGM">
        <source src="æ „å…‰ã®ãƒ•ã‚¡ãƒ³ãƒ•ã‚¡ãƒ¼ãƒ¬ã®ã‚³ãƒ”ãƒ¼.mp3" type="audio/mpeg">
    </audio>

    <!-- BGM Control Panel -->
    <div class="bgm-control collapsed" id="bgmControl">
        <div class="bgm-header" onclick="toggleBGMPanel()">
            <span class="bgm-title">
                â™ª BGM
                <span class="bgm-toggle-icon">â–¼</span>
            </span>
        </div>
        <div class="bgm-now-playing" id="nowPlaying">æ·±æ€ªãªè¬</div>
        <div class="bgm-controls">
            <button class="bgm-mute-btn" id="muteBtn" onclick="toggleMute()">
                <span id="muteText">ğŸ”Š ON</span>
            </button>
            <div class="volume-control">
                <input type="range" min="0" max="100" value="50" class="volume-slider" id="volumeSlider">
                <span class="volume-label" id="volumeLabel">50%</span>
            </div>
        </div>
    </div>

    <div class="background-pattern"></div>
    <div class="container">
        <header>
            <h1>æ±äº¬ãƒŸãƒƒãƒ‰ãƒŠã‚¤ãƒˆæ®ºäººäº‹ä»¶</h1>
            <p class="subtitle">TOKYO MIDNIGHT MURDER</p>
        </header>

        <div class="intro-screen" id="introScreen">
            <div class="intro-content">
                <p>2025å¹´11æœˆ22æ—¥ã€åˆå¾Œ11æ™‚47åˆ†ã€‚</p>
                <p>æ±äº¬ãƒ»å…­æœ¬æœ¨ã®é«˜å±¤ãƒãƒ³ã‚·ãƒ§ãƒ³æœ€ä¸Šéšã«ã‚ã‚‹ãƒšãƒ³ãƒˆãƒã‚¦ã‚¹ã€‚ITä¼æ¥­ã®è‹¥ãçµŒå–¶è€…ã€<strong>ç›¸æ¾¤éš†ä¸€</strong>ï¼ˆ38æ­³ï¼‰ãŒè‡ªå®…ã§æ­»äº¡ã—ã¦ã„ã‚‹ã®ãŒç™ºè¦‹ã•ã‚ŒãŸã€‚</p>

                <div class="victim-info">
                    <p><strong>è¢«å®³è€…:</strong> ç›¸æ¾¤éš†ä¸€ï¼ˆã‚ã„ã–ã‚ ã‚Šã‚…ã†ã„ã¡ï¼‰</p>
                    <p><strong>æ­»äº¡æ¨å®šæ™‚åˆ»:</strong> åˆå¾Œ10æ™‚30åˆ†ã€œ11æ™‚00åˆ†</p>
                    <p><strong>æ­»å› :</strong> å¾Œé ­éƒ¨ã¸ã®éˆå™¨ã«ã‚ˆã‚‹å¼·æ‰“ã€‚å‡¶å™¨ã¯æœªç™ºè¦‹ã€‚</p>
                    <p><strong>ç™ºè¦‹çŠ¶æ³:</strong> æ›¸æ–ã«ã¦å€’ã‚Œã¦ã„ã‚‹ã¨ã“ã‚ã‚’ç§˜æ›¸ãŒç™ºè¦‹ã€‚çª“ã¯æ–½éŒ ã•ã‚Œã€ç„é–¢ã®é›»å­ãƒ­ãƒƒã‚¯ã«ã¯ä¸å¯©ãªè¨˜éŒ²ãªã—ã€‚</p>
                </div>

                <p>ãã®å¤œã€ç›¸æ¾¤ã®ãƒšãƒ³ãƒˆãƒã‚¦ã‚¹ã«ã¯5äººã®äººç‰©ãŒã„ãŸã€‚å…¨å“¡ã«ã‚¢ãƒªãƒã‚¤ãŒã‚ã‚Šã€å…¨å“¡ã«å‹•æ©ŸãŒã‚ã‚‹ã€‚</p>
                <p>ã‚ãªãŸã¯åˆ‘äº‹ã¨ã—ã¦ã€è¨¼æ‹ ã‚’é›†ã‚ã€çŸ›ç›¾ã‚’è¦‹ã¤ã‘å‡ºã—ã€çœŸçŠ¯äººã‚’ç‰¹å®šã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚</p>
                <p style="margin-top: 30px; color: var(--accent-gold); font-weight: 600;">æ³¨æ„: ã“ã®ã‚²ãƒ¼ãƒ ã¯é«˜åº¦ãªè«–ç†çš„æ€è€ƒã‚’è¦æ±‚ã—ã¾ã™ã€‚å…¨ã¦ã®è¨¼æ‹ ã¨è¨¼è¨€ã‚’æ³¨æ„æ·±ãæ¤œè¨¼ã—ã¦ãã ã•ã„ã€‚</p>

                <button class="start-btn" onclick="startGame()">æœæŸ»ã‚’é–‹å§‹ã™ã‚‹</button>
            </div>
        </div>

        <div class="game-screen" id="gameScreen">
            <div class="game-layout">
                <div class="suspects-panel">
                    <div class="panel-title">å®¹ç–‘è€…ãƒªã‚¹ãƒˆ</div>
                    <div class="suspect-card" onclick="showSuspect(0)">
                        <div class="suspect-name">æ°´é‡ç¾å’²</div>
                        <div class="suspect-role">ç§˜æ›¸ãƒ»29æ­³</div>
                    </div>
                    <div class="suspect-card" onclick="showSuspect(1)">
                        <div class="suspect-name">ç›¸æ¾¤éº»è¡£</div>
                        <div class="suspect-role">å¦»ãƒ»34æ­³</div>
                    </div>
                    <div class="suspect-card" onclick="showSuspect(2)">
                        <div class="suspect-name">ç”°ä¸­å¥å¤ª</div>
                        <div class="suspect-role">ãƒ“ã‚¸ãƒã‚¹ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ãƒ»42æ­³</div>
                    </div>
                    <div class="suspect-card" onclick="showSuspect(3)">
                        <div class="suspect-name">ä½è—¤å„ªå­</div>
                        <div class="suspect-role">å…ƒæ‹äººãƒ»31æ­³</div>
                    </div>
                    <div class="suspect-card" onclick="showSuspect(4)">
                        <div class="suspect-name">å±±æœ¬å¤§è¼”</div>
                        <div class="suspect-role">å¼Ÿãƒ»33æ­³</div>
                    </div>
                </div>

                <div class="main-panel" id="mainPanel">
                    <!-- å®¹ç–‘è€…è©³ç´°ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã‚‹ -->
                </div>

                <div class="evidence-panel scrollbar">
                    <div class="panel-title">åé›†ã—ãŸè¨¼æ‹ </div>
                    <div id="evidenceList">
                        <div class="evidence-item">
                            <div class="evidence-title">åŸºæœ¬æƒ…å ±</div>
                            <p>è¢«å®³è€…ã®è‡ªå®…ã¯32éšå»ºã¦ã®æœ€ä¸Šéšã€‚ã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼ã¯æš—è¨¼ç•ªå·å¼ã§ã€ãã®å¤œã®ãƒ­ã‚°ã«ã¯5äººã®å®¹ç–‘è€…ã®ã¿ãŒè¨˜éŒ²ã•ã‚Œã¦ã„ã‚‹ã€‚</p>
                        </div>
                        <div class="evidence-item">
                            <div class="evidence-title">ç¾å ´ã®çŠ¶æ³</div>
                            <p>æ›¸æ–ã®ãƒ‰ã‚¢ã¯å†…å´ã‹ã‚‰æ–½éŒ ã•ã‚Œã¦ã„ãªã‹ã£ãŸã€‚è¢«å®³è€…ã®ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã«ã¯åˆå¾Œ10æ™‚23åˆ†ã«ç€ä¿¡å±¥æ­´ã‚ã‚Šã€‚</p>
                        </div>
                    </div>

                    <div class="accusation-panel">
                        <div class="panel-title">çŠ¯äººã‚’å‘Šç™ºã™ã‚‹</div>
                        <p style="font-size: 0.9em; margin-bottom: 15px; color: var(--text-dim);">å…¨ã¦ã®è¨¼æ‹ ã‚’æ¤œè¨¼ã—ã€çŠ¯äººã‚’ç‰¹å®šã—ã¦ãã ã•ã„ã€‚</p>
                        <button class="accusation-btn" onclick="openAccusationModal()">å‘Šç™ºã™ã‚‹</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="result-screen" id="resultScreen">
            <!-- çµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã‚‹ -->
        </div>
    </div>

    <div id="accusationModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeAccusationModal()">&times;</span>
            <h2 style="color: var(--accent-gold); margin-bottom: 30px;">çŠ¯äººã‚’å‘Šç™ºã™ã‚‹</h2>
            <p style="margin-bottom: 20px;">èª°ãŒçœŸçŠ¯äººã ã¨æ€ã„ã¾ã™ã‹?</p>
            <div id="suspectOptions"></div>
            <button class="submit-accusation" onclick="submitAccusation()">å‘Šç™ºã‚’ç¢ºå®šã™ã‚‹</button>
        </div>
    </div>

    <script>
        // ===== BGM Management =====
        const bgmTracks = {
            default: document.getElementById('defaultBGM'),
            accusation: document.getElementById('accusationBGM'),
            clear: document.getElementById('clearBGM')
        };

        const bgmNames = {
            default: 'æ·±æ€ªãªè¬',
            accusation: 'Resolution',
            clear: 'æ „å…‰ã®ãƒ•ã‚¡ãƒ³ãƒ•ã‚¡ãƒ¼ãƒ¬'
        };

        let currentBGM = null;
        let isMuted = false;
        let currentVolume = 0.5;

        // Initialize BGM system
        function initBGM() {
            // Load saved volume from localStorage
            const savedVolume = localStorage.getItem('bgm_volume');
            const savedMute = localStorage.getItem('bgm_mute');

            if (savedVolume !== null) {
                currentVolume = parseFloat(savedVolume);
                document.getElementById('volumeSlider').value = currentVolume * 100;
                document.getElementById('volumeLabel').textContent = Math.round(currentVolume * 100) + '%';
            }

            if (savedMute === 'true') {
                isMuted = true;
                document.getElementById('muteBtn').classList.add('muted');
                document.getElementById('muteText').textContent = 'ğŸ”‡ OFF';
            }

            // Set initial volume for all tracks
            Object.values(bgmTracks).forEach(audio => {
                audio.volume = isMuted ? 0 : currentVolume;
            });

            // Volume slider event
            document.getElementById('volumeSlider').addEventListener('input', function(e) {
                currentVolume = e.target.value / 100;
                document.getElementById('volumeLabel').textContent = e.target.value + '%';

                if (!isMuted) {
                    Object.values(bgmTracks).forEach(audio => {
                        audio.volume = currentVolume;
                    });
                }

                localStorage.setItem('bgm_volume', currentVolume);
            });
        }

        function toggleMute() {
            isMuted = !isMuted;
            const muteBtn = document.getElementById('muteBtn');
            const muteText = document.getElementById('muteText');

            if (isMuted) {
                muteBtn.classList.add('muted');
                muteText.textContent = 'ğŸ”‡ OFF';
                Object.values(bgmTracks).forEach(audio => {
                    audio.volume = 0;
                });
            } else {
                muteBtn.classList.remove('muted');
                muteText.textContent = 'ğŸ”Š ON';
                Object.values(bgmTracks).forEach(audio => {
                    audio.volume = currentVolume;
                });
            }

            localStorage.setItem('bgm_mute', isMuted);
        }

        function playBGM(bgmType, fadeIn = true) {
            const newBGM = bgmTracks[bgmType];

            // Update now playing text
            document.getElementById('nowPlaying').textContent = bgmNames[bgmType];

            // Stop current BGM with fade out
            if (currentBGM && currentBGM !== newBGM) {
                fadeOutBGM(currentBGM);
            }

            // Play new BGM
            currentBGM = newBGM;
            newBGM.currentTime = 0;

            if (fadeIn) {
                newBGM.volume = 0;
                newBGM.play().catch(err => console.log('BGM play failed:', err));
                fadeInBGM(newBGM);
            } else {
                newBGM.volume = isMuted ? 0 : currentVolume;
                newBGM.play().catch(err => console.log('BGM play failed:', err));
            }
        }

        function fadeInBGM(audio) {
            const targetVolume = isMuted ? 0 : currentVolume;
            const fadeStep = targetVolume / 20;
            let currentStep = 0;

            const fadeInterval = setInterval(() => {
                currentStep++;
                audio.volume = Math.min(fadeStep * currentStep, targetVolume);

                if (currentStep >= 20) {
                    clearInterval(fadeInterval);
                }
            }, 50);
        }

        function fadeOutBGM(audio) {
            const initialVolume = audio.volume;
            const fadeStep = initialVolume / 20;
            let currentStep = 0;

            const fadeInterval = setInterval(() => {
                currentStep++;
                audio.volume = Math.max(initialVolume - (fadeStep * currentStep), 0);

                if (currentStep >= 20) {
                    clearInterval(fadeInterval);
                    audio.pause();
                    audio.currentTime = 0;
                }
            }, 50);
        }

        function stopAllBGM() {
            Object.values(bgmTracks).forEach(audio => {
                audio.pause();
                audio.currentTime = 0;
            });
            currentBGM = null;
        }

        // Toggle BGM panel
        function toggleBGMPanel() {
            const panel = document.getElementById('bgmControl');
            const isCollapsed = panel.classList.contains('collapsed');

            if (isCollapsed) {
                panel.classList.remove('collapsed');
                panel.classList.add('expanded');
                localStorage.setItem('bgm_panel_state', 'expanded');
            } else {
                panel.classList.remove('expanded');
                panel.classList.add('collapsed');
                localStorage.setItem('bgm_panel_state', 'collapsed');
            }
        }

        // Initialize BGM on page load
        window.addEventListener('DOMContentLoaded', function() {
            initBGM();

            // Restore panel state
            const savedState = localStorage.getItem('bgm_panel_state');
            if (savedState === 'expanded') {
                const panel = document.getElementById('bgmControl');
                panel.classList.remove('collapsed');
                panel.classList.add('expanded');
            }
        });

        // ===== Game Logic =====
        const suspects = [
            {
                name: "æ°´é‡ç¾å’²",
                role: "ç§˜æ›¸ãƒ»29æ­³",
                profile: "ç›¸æ¾¤ã®ç§˜æ›¸ã¨ã—ã¦3å¹´é–“å‹¤å‹™ã€‚æœ‰èƒ½ã§ä¿¡é ¼ã•ã‚Œã¦ã„ãŸãŒã€æœ€è¿‘ã¯éåº¦ãªè¦æ±‚ã«æ‚©ã‚“ã§ã„ãŸã€‚",
                motive: "ç›¸æ¾¤ã‹ã‚‰ã®ãƒ‘ãƒ¯ãƒãƒ©ã¨ã‚»ã‚¯ãƒãƒ©ã«é•·å¹´è‹¦ã—ã‚“ã§ã„ãŸã€‚å…ˆé€±ã€é€€è·ã‚’ç”³ã—å‡ºãŸãŒå´ä¸‹ã•ã‚Œã€ã€Œæ¥­ç•Œã§åƒã‘ãªãã—ã¦ã‚„ã‚‹ã€ã¨è„…ã•ã‚ŒãŸã€‚",
                alibi: "åˆå¾Œ10æ™‚15åˆ†ã«ç›¸æ¾¤ã‹ã‚‰å‘¼ã³å‡ºã•ã‚Œã€æ›¸æ–ã¸ã€‚10æ™‚30åˆ†ã¾ã§ä»•äº‹ã®æŒ‡ç¤ºã‚’å—ã‘ã¦ã„ãŸã€‚ãã®å¾Œãƒªãƒ“ãƒ³ã‚°ã§æ›¸é¡ä½œæˆã‚’ã—ã¦ãŠã‚Šã€10æ™‚50åˆ†é ƒã«ç”°ä¸­ã¨ä¼šè©±ã€‚11æ™‚30åˆ†ã«æ›¸æ–ã‚’è¨ªã‚Œã€éºä½“ã‚’ç™ºè¦‹ã€‚",
                questions: [
                    {
                        q: "10æ™‚30åˆ†ä»¥é™ã€ã©ã“ã«ã„ã¾ã—ãŸã‹?",
                        a: "ãƒªãƒ“ãƒ³ã‚°ã§æ›¸é¡ã‚’ä½œæˆã—ã¦ã„ã¾ã—ãŸã€‚10æ™‚50åˆ†é ƒã€ç”°ä¸­ã•ã‚“ãŒã‚³ãƒ¼ãƒ’ãƒ¼ã‚’æ·¹ã‚Œã«æ¥ã¦ã€å°‘ã—é›‘è«‡ã—ã¾ã—ãŸã€‚",
                        evidence: "ãƒªãƒ“ãƒ³ã‚°ã®PCã«ã¯10æ™‚32åˆ†ã‹ã‚‰10æ™‚58åˆ†ã¾ã§ã®ç·¨é›†å±¥æ­´ã‚ã‚Š"
                    },
                    {
                        q: "ç›¸æ¾¤ã•ã‚“ã¨ã®é–¢ä¿‚ã¯?",
                        a: "...æ­£ç›´ã«è¨€ã†ã¨ã€æœ€æ‚ªã§ã—ãŸã€‚é€€è·ã—ãŸã‹ã£ãŸã®ã«è„…ã•ã‚Œã¦ã€‚ã§ã‚‚æ®ºã—ã¦ã¯ã„ã¾ã›ã‚“ã€‚",
                        evidence: null
                    },
                    {
                        q: "æ›¸æ–ã«å…¥ã£ãŸæ™‚ã®æ§˜å­ã¯?",
                        a: "ãƒ‰ã‚¢ã¯é–‰ã¾ã£ã¦ã„ã¾ã—ãŸãŒã€éµã¯ã‹ã‹ã£ã¦ã„ã¾ã›ã‚“ã§ã—ãŸã€‚ãƒãƒƒã‚¯ã—ã¦ã‚‚è¿”äº‹ãŒãªãã€ä¸å¯©ã«æ€ã£ã¦å…¥ã‚‹ã¨...å€’ã‚Œã¦ã„ã¾ã—ãŸã€‚",
                        evidence: "æ›¸æ–ã®ãƒ‰ã‚¢ãƒãƒ–ã«æ°´é‡ã®æŒ‡ç´‹ã‚ã‚Šï¼ˆç™ºè¦‹æ™‚ã®ã‚‚ã®ï¼‰"
                    }
                ]
            },
            {
                name: "ç›¸æ¾¤éº»è¡£",
                role: "å¦»ãƒ»34æ­³",
                profile: "ç›¸æ¾¤ã¨çµå©šã—ã¦5å¹´ã€‚å…ƒãƒ¢ãƒ‡ãƒ«ã§ã€ç¾åœ¨ã¯ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³ãƒ–ãƒ©ãƒ³ãƒ‰ã‚’çµŒå–¶ã€‚å¤«å©¦ä»²ã¯å†·ãˆåˆ‡ã£ã¦ã„ãŸã€‚",
                motive: "å¤«ã®æµ®æ°—ã¨ã€é›¢å©šæ™‚ã®è²¡ç”£åˆ†ä¸ã‚’å·¡ã£ã¦å¯¾ç«‹ã€‚ç›¸æ¾¤ã¯é›¢å©šã‚’æ‹’å¦ã—ã€éº»è¡£ã®ãƒ–ãƒ©ãƒ³ãƒ‰äº‹æ¥­ã¸ã®æŠ•è³‡ã‚’äººè³ªã«å–ã£ã¦ã„ãŸã€‚æ­»äº¡ã«ã‚ˆã‚Šå…¨è²¡ç”£ã‚’ç›¸ç¶šã§ãã‚‹ã€‚",
                alibi: "åˆå¾Œ9æ™‚ã‹ã‚‰è‡ªå®¤ã§é€šè©±ã€‚10æ™‚ã«é€šè©±çµ‚äº†å¾Œã€ãƒ¯ã‚¤ãƒ³ã‚’é£²ã¿ãªãŒã‚‰é›‘èªŒã‚’èª­ã‚“ã§ã„ãŸã€‚10æ™‚40åˆ†é ƒã€ã‚­ãƒƒãƒãƒ³ã§ä½è—¤ã¨é­é‡ã€‚11æ™‚éãã«é¨’ãã‚’èã„ã¦æ›¸æ–ã¸ã€‚",
                questions: [
                    {
                        q: "10æ™‚ã‹ã‚‰10æ™‚40åˆ†ã¾ã§ä½•ã‚’ã—ã¦ã„ã¾ã—ãŸã‹?",
                        a: "è‡ªå®¤ã§ãƒ¯ã‚¤ãƒ³ã‚’é£²ã‚“ã§ã„ã¾ã—ãŸã€‚ä¸€äººã§ã€‚èª°ã‚‚è¨¼æ˜ã§ãã¾ã›ã‚“ãŒã€æœ¬å½“ã§ã™ã€‚",
                        evidence: "è‡ªå®¤ã®ãƒ¯ã‚¤ãƒ³ã‚°ãƒ©ã‚¹ã‹ã‚‰éº»è¡£ã®æŒ‡ç´‹ã¨å”‡ç´‹ã‚’æ¤œå‡º"
                    },
                    {
                        q: "è²¡ç”£ç›¸ç¶šã«ã¤ã„ã¦çŸ¥ã£ã¦ã„ã¾ã—ãŸã‹?",
                        a: "...ãˆãˆã€çŸ¥ã£ã¦ã„ã¾ã—ãŸã€‚ã§ã‚‚ç§ã«ã¯è‡ªåˆ†ã®äº‹æ¥­ãŒã‚ã‚Šã¾ã™ã€‚å¤«ã®é‡‘ãŒæ¬²ã—ãã¦æ®ºã™ãªã‚“ã¦ã€‚",
                        evidence: null
                    },
                    {
                        q: "ã‚­ãƒƒãƒãƒ³ã§ä½è—¤ã•ã‚“ã«ä¼šã£ãŸæ™‚ã€ä½•ã‚’?",
                        a: "æ°´ã‚’å–ã‚Šã«æ¥ãŸã‚‰ä½è—¤ã•ã‚“ãŒã„ã¦ã€‚å°‘ã—æ°—ã¾ãšã„é›°å›²æ°—ã§ã—ãŸã€‚å½¼å¥³ã€å…ƒã‚«ãƒã§ã™ã‹ã‚‰ã€‚",
                        evidence: "ã‚­ãƒƒãƒãƒ³ã®ãƒŸãƒãƒ©ãƒ«ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ã®ãƒœãƒˆãƒ«ã«éº»è¡£ã¨ä½è—¤ã®æŒ‡ç´‹"
                    }
                ]
            },
            {
                name: "ç”°ä¸­å¥å¤ª",
                role: "ãƒ“ã‚¸ãƒã‚¹ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ãƒ»42æ­³",
                profile: "ç›¸æ¾¤ã¨å…±åŒã§äº‹æ¥­ã‚’ç«‹ã¡ä¸Šã’ãŸå…±åŒçµŒå–¶è€…ã€‚æœ€è¿‘ã€çµŒå–¶æ–¹é‡ã‚’å·¡ã£ã¦å¯¾ç«‹ã—ã¦ã„ãŸã€‚",
                motive: "ç›¸æ¾¤ãŒç‹¬æ–­ã§å±é™ºãªæŠ•è³‡ã‚’è¡Œã„ã€ä¼šç¤¾ã‚’å±æ©Ÿã«é™¥ã‚ŒãŸã€‚å…ˆæœˆã€ç›¸æ¾¤ã‚’çµŒå–¶ã‹ã‚‰å¤–ãã†ã¨ã—ãŸãŒå¤±æ•—ã€‚ä¼šç¤¾ã®æ ªå¼ã®60%ã‚’ç›¸æ¾¤ãŒä¿æœ‰ã—ã¦ãŠã‚Šã€æ­»äº¡ã™ã‚Œã°è²·ã„å–ã‚Šã®æ©Ÿä¼šãŒç”Ÿã¾ã‚Œã‚‹ã€‚",
                alibi: "åˆå¾Œ9æ™‚30åˆ†ã«åˆ°ç€ã€‚ç›¸æ¾¤ã¨æ›¸æ–ã§ä¼šè­°ã€‚10æ™‚15åˆ†ã«ä¼šè­°çµ‚äº†ã€ãã®å¾Œã‚²ã‚¹ãƒˆãƒ«ãƒ¼ãƒ ã§é›»è©±ä¼šè­°ã€‚10æ™‚50åˆ†é ƒã‚­ãƒƒãƒãƒ³ã§ã‚³ãƒ¼ãƒ’ãƒ¼ã‚’æ·¹ã‚Œã€æ°´é‡ã¨ä¼šè©±ã€‚11æ™‚15åˆ†ã¾ã§é›»è©±ä¼šè­°ç¶™ç¶šã€‚",
                questions: [
                    {
                        q: "10æ™‚15åˆ†ä»¥é™ã€ãšã£ã¨é›»è©±ä¼šè­°ã§ã—ãŸã‹?",
                        a: "ã¯ã„ã€‚æµ·å¤–ã®æŠ•è³‡å®¶ã¨ã®é‡è¦ãªä¼šè­°ã§ã—ãŸã€‚ãƒ­ã‚°ã‚’è¦‹ã‚Œã°åˆ†ã‹ã‚Šã¾ã™ã€‚10æ™‚17åˆ†ã‹ã‚‰11æ™‚15åˆ†ã¾ã§ã€‚",
                        evidence: "ã‚²ã‚¹ãƒˆãƒ«ãƒ¼ãƒ ã®PCã«10æ™‚17åˆ†ã€œ11æ™‚15åˆ†ã®ãƒ“ãƒ‡ã‚ªä¼šè­°è¨˜éŒ²ã‚ã‚Š"
                    },
                    {
                        q: "ç›¸æ¾¤ã•ã‚“ã¨ã®ä¼šè­°ã®å†…å®¹ã¯?",
                        a: "...ä¾‹ã®ç„¡è¬€ãªæŠ•è³‡ã«ã¤ã„ã¦ã€‚æ­¢ã‚ã‚‹ã‚ˆã†èª¬å¾—ã—ã¾ã—ãŸãŒã€èãè€³ã‚’æŒãŸãªã‹ã£ãŸã€‚",
                        evidence: null
                    },
                    {
                        q: "10æ™‚50åˆ†ã«ã‚­ãƒƒãƒãƒ³ã«è¡Œã£ãŸã®ã¯?",
                        a: "ä¼šè­°ã®åˆé–“ã®ä¼‘æ†©ã§ã™ã€‚ã‚³ãƒ¼ãƒ’ãƒ¼ã‚’æ·¹ã‚Œã«ã€‚æ°´é‡ã•ã‚“ãŒã„ã¦ã€å°‘ã—è©±ã—ã¾ã—ãŸã€‚",
                        evidence: "ã‚­ãƒƒãƒãƒ³ã®ã‚³ãƒ¼ãƒ’ãƒ¼ãƒ¡ãƒ¼ã‚«ãƒ¼ä½¿ç”¨è¨˜éŒ²: 10æ™‚49åˆ†"
                    }
                ]
            },
            {
                name: "ä½è—¤å„ªå­",
                role: "å…ƒæ‹äººãƒ»31æ­³",
                profile: "ç›¸æ¾¤ã®å¤§å­¦æ™‚ä»£ã®æ‹äººã€‚5å¹´å‰ã«ç›¸æ¾¤ãŒéº»è¡£ã¨çµå©šã—ãŸã“ã¨ã§åˆ¥ã‚ŒãŸãŒã€æœ€è¿‘å†ã³æ¥è§¦ã—ã¦ã„ãŸã€‚",
                motive: "ç›¸æ¾¤ã‹ã‚‰ã€Œã‚„ã‚Šç›´ãã†ã€ã¨è¨€ã‚ã‚Œã€é›¢å©šã‚’ä¿¡ã˜ã¦é–¢ä¿‚ã‚’å†é–‹ã€‚ã—ã‹ã—å®Ÿéš›ã¯é›¢å©šã™ã‚‹æ°—ãªã©ãªãã€éƒ½åˆã®è‰¯ã„é–¢ä¿‚ã‚’ç¶šã‘ã‚‹ã¤ã‚‚ã‚Šã ã£ãŸã¨çŸ¥ã‚Šæ¿€æ€’ã€‚",
                alibi: "åˆå¾Œ10æ™‚ã«åˆ°ç€ã€‚ç›¸æ¾¤ã«å‘¼ã°ã‚ŒãŸãŒã€æ›¸æ–ã«ã¯å…¥ã‚‰ãšå»Šä¸‹ã§å¾…ã¤ã‚ˆã†è¨€ã‚ã‚ŒãŸã€‚10æ™‚20åˆ†é ƒã¾ã§å»Šä¸‹ã§å¾…æ©Ÿã€‚ç—ºã‚Œã‚’åˆ‡ã‚‰ã—ã¦ãƒªãƒ“ãƒ³ã‚°ã¸ã€‚10æ™‚40åˆ†é ƒã‚­ãƒƒãƒãƒ³ã§éº»è¡£ã¨é­é‡ã€‚11æ™‚é ƒã¾ã§å±…é–“ã®ã‚½ãƒ•ã‚¡ã§é›‘èªŒã‚’èª­ã‚€ã€‚",
                questions: [
                    {
                        q: "å»Šä¸‹ã§å¾…ã£ã¦ã„ã‚‹é–“ã€ä½•ã‹èã“ãˆã¾ã—ãŸã‹?",
                        a: "æ›¸æ–ã‹ã‚‰ã¯...ç›¸æ¾¤ã•ã‚“ã¨æ°´é‡ã•ã‚“ã®å£°ãŒèã“ãˆã¾ã—ãŸã€‚10æ™‚15åˆ†é ƒã«æ°´é‡ã•ã‚“ãŒå‡ºã¦ãã¾ã—ãŸã€‚",
                        evidence: null
                    },
                    {
                        q: "ãªãœãã®å¤œå‘¼ã°ã‚ŒãŸã®ã§ã™ã‹?",
                        a: "ç›¸æ¾¤ã•ã‚“ãŒã€Œå¤§äº‹ãªè©±ãŒã‚ã‚‹ã€ã¨ã€‚ã§ã‚‚çµå±€ã€å¾…ãŸã•ã‚ŒãŸã ã‘ã§...ä¼šãˆã¾ã›ã‚“ã§ã—ãŸã€‚",
                        evidence: "ä½è—¤ã®ã‚¹ãƒãƒ›ã«åˆå¾Œ8æ™‚47åˆ†ã€ç›¸æ¾¤ã‹ã‚‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€Œä»Šå¤œ10æ™‚ã«æ¥ã¦ãã‚Œã€‚å›ã«ä¼ãˆãŸã„ã“ã¨ãŒã‚ã‚‹ã€"
                    },
                    {
                        q: "éº»è¡£ã•ã‚“ã¨ä¼šã£ãŸæ™‚ã®æ§˜å­ã¯?",
                        a: "...æ°—ã¾ãšã‹ã£ãŸã§ã™ã€‚ãŠäº’ã„ä½•ã‚‚è¨€ã„ã¾ã›ã‚“ã§ã—ãŸãŒã€ç§ãŒä½•è€…ã‹çŸ¥ã£ã¦ã„ã‚‹ã‚ˆã†ãªç›®ã§è¦‹ã‚‰ã‚Œã¾ã—ãŸã€‚",
                        evidence: null
                    }
                ]
            },
            {
                name: "å±±æœ¬å¤§è¼”",
                role: "å¼Ÿãƒ»33æ­³",
                profile: "ç›¸æ¾¤ã®ç¾©ç†ã®å¼Ÿï¼ˆéº»è¡£ã®å®Ÿå¼Ÿï¼‰ã€‚ç›¸æ¾¤ã®ä¼šç¤¾ã§åƒã„ã¦ã„ã‚‹ãŒã€èƒ½åŠ›ä¸è¶³ã‚’ç†ç”±ã«å†·é‡ã•ã‚Œã¦ã„ãŸã€‚",
                motive: "ç›¸æ¾¤ã‹ã‚‰æ—¥å¸¸çš„ã«ãƒ‘ãƒ¯ãƒãƒ©ã‚’å—ã‘ã€ã€Œç„¡èƒ½ãªç¾©å¼Ÿã€ã¨ä¾®è¾±ã•ã‚Œã¦ã„ãŸã€‚å…ˆé€±ã€æ¨ªé ˜ã®æ¿¡ã‚Œè¡£ã‚’ç€ã›ã‚‰ã‚Œãã†ã«ãªã‚Šã€å§‰ã®éº»è¡£ã«ç›¸è«‡ã™ã‚‹ã‚‚å–ã‚Šåˆã£ã¦ã‚‚ã‚‰ãˆãšã€‚",
                alibi: "åˆå¾Œ9æ™‚45åˆ†ã«åˆ°ç€ã€‚ç›¸æ¾¤ã‹ã‚‰å‘¼ã³å‡ºã•ã‚Œã¦ã„ãŸã€‚10æ™‚ã¾ã§æ›¸æ–ã§ç›¸æ¾¤ã¨å£è«–ã€‚ãã®å¾Œãƒãƒ«ã‚³ãƒ‹ãƒ¼ã§ã‚¿ãƒã‚³ã‚’å¸ã„ã€10æ™‚30åˆ†é ƒã«æˆ»ã‚‹ã€‚ãƒªãƒ“ãƒ³ã‚°ã§æ™‚é–“ã‚’æ½°ã—ã€11æ™‚éãã«é¨’ãã‚’èãã€‚",
                questions: [
                    {
                        q: "ãƒãƒ«ã‚³ãƒ‹ãƒ¼ã«ã„ãŸæ™‚é–“ã¯?",
                        a: "10æ™‚ã‹ã‚‰10æ™‚30åˆ†ãã‚‰ã„ã¾ã§ã€‚ã‚¿ãƒã‚³ã‚’3æœ¬å¸ã„ã¾ã—ãŸã€‚å¯’ã‹ã£ãŸã‘ã©ã€é ­ã‚’å†·ã‚„ã—ãŸãã¦ã€‚",
                        evidence: "ãƒãƒ«ã‚³ãƒ‹ãƒ¼ã®ç°çš¿ã«æ–°ã—ã„å¸ã„æ®»3æœ¬ï¼ˆå±±æœ¬ã®å¸ã£ã¦ã„ã‚‹éŠ˜æŸ„ï¼‰"
                    },
                    {
                        q: "å£è«–ã®å†…å®¹ã¯?",
                        a: "...æ¨ªé ˜ã®ä»¶ã§ã™ã€‚ã‚„ã£ã¦ã‚‚ã„ãªã„ã®ã«ã€‚è¨¼æ‹ ã‚‚ãªã„ãã›ã«ã€è„…ã—ã¦ãã¦ã€‚ã‚‚ã†é™ç•Œã§ã—ãŸã€‚",
                        evidence: null
                    },
                    {
                        q: "ãƒãƒ«ã‚³ãƒ‹ãƒ¼ã‹ã‚‰æ›¸æ–ã¯è¦‹ãˆã¾ã™ã‹?",
                        a: "ã„ãˆã€åå¯¾å´ã§ã™ã€‚ãƒãƒ«ã‚³ãƒ‹ãƒ¼ã¯æ±å´ã€æ›¸æ–ã¯è¥¿å´ã«ã‚ã‚Šã¾ã™ã€‚",
                        evidence: "é–“å–ã‚Šå›³ã«ã‚ˆã‚Šç¢ºèª: ãƒãƒ«ã‚³ãƒ‹ãƒ¼ã¨æ›¸æ–ã¯åå¯¾å´"
                    }
                ]
            }
        ];

        let collectedEvidence = [];
        let selectedSuspect = null;
        let currentSuspect = 0;

        const murdererId = 2; // ç”°ä¸­å¥å¤ªãŒçœŸçŠ¯äºº

        function startGame() {
            document.getElementById('introScreen').style.display = 'none';
            document.getElementById('gameScreen').style.display = 'block';
            showSuspect(0);

            // Start default BGM
            playBGM('default', true);
        }

        function showSuspect(index) {
            currentSuspect = index;
            const cards = document.querySelectorAll('.suspect-card');
            cards.forEach((card, i) => {
                card.classList.toggle('active', i === index);
            });

            const suspect = suspects[index];
            const mainPanel = document.getElementById('mainPanel');

            let questionsHTML = '';
            suspect.questions.forEach((q, i) => {
                questionsHTML += `
                    <div style="margin-bottom: 20px;">
                        <button class="question-btn" onclick="askQuestion(${index}, ${i})" id="q${index}_${i}">
                            è³ªå•: ${q.q}
                        </button>
                        <div class="answer-box" id="a${index}_${i}">
                            <p><strong>å›ç­”:</strong> ${q.a}</p>
                        </div>
                    </div>
                `;
            });

            mainPanel.innerHTML = `
                <div class="suspect-detail active">
                    <h2 style="color: var(--accent-gold); margin-bottom: 20px;">${suspect.name}</h2>

                    <div class="detail-section">
                        <h3>ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«</h3>
                        <p>${suspect.profile}</p>
                    </div>

                    <div class="detail-section">
                        <h3>å‹•æ©Ÿ</h3>
                        <p style="color: var(--accent-red);">${suspect.motive}</p>
                    </div>

                    <div class="detail-section">
                        <h3>ã‚¢ãƒªãƒã‚¤</h3>
                        <div class="alibi-box">
                            ${suspect.alibi}
                        </div>
                    </div>

                    <div class="detail-section">
                        <h3>å°‹å•</h3>
                        ${questionsHTML}
                    </div>
                </div>
            `;
        }

        function askQuestion(suspectIndex, questionIndex) {
            const answerBox = document.getElementById(`a${suspectIndex}_${questionIndex}`);
            const button = document.getElementById(`q${suspectIndex}_${questionIndex}`);

            answerBox.classList.add('show');
            button.disabled = true;

            const evidence = suspects[suspectIndex].questions[questionIndex].evidence;
            if (evidence) {
                addEvidence(evidence);
            }
        }

        function addEvidence(evidenceText) {
            if (collectedEvidence.includes(evidenceText)) return;

            collectedEvidence.push(evidenceText);
            const evidenceList = document.getElementById('evidenceList');
            const evidenceItem = document.createElement('div');
            evidenceItem.className = 'evidence-item new';
            evidenceItem.innerHTML = `
                <div class="evidence-title">æ–°ã—ã„è¨¼æ‹  #${collectedEvidence.length}</div>
                <p>${evidenceText}</p>
            `;
            evidenceList.appendChild(evidenceItem);

            setTimeout(() => {
                evidenceItem.classList.remove('new');
            }, 3000);
        }

        function openAccusationModal() {
            const modal = document.getElementById('accusationModal');
            const optionsDiv = document.getElementById('suspectOptions');

            optionsDiv.innerHTML = '';
            suspects.forEach((suspect, index) => {
                const option = document.createElement('div');
                option.className = 'suspect-option';
                option.onclick = () => selectSuspectForAccusation(index);
                option.id = `option${index}`;
                option.innerHTML = `
                    <div class="suspect-name">${suspect.name}</div>
                    <div class="suspect-role">${suspect.role}</div>
                `;
                optionsDiv.appendChild(option);
            });

            modal.style.display = 'block';

            // Switch to accusation BGM
            playBGM('accusation', true);
        }

        function closeAccusationModal() {
            document.getElementById('accusationModal').style.display = 'none';
            selectedSuspect = null;

            // Return to default BGM
            playBGM('default', true);
        }

        function selectSuspectForAccusation(index) {
            selectedSuspect = index;
            document.querySelectorAll('.suspect-option').forEach((option, i) => {
                option.classList.toggle('selected', i === index);
            });
        }

        function submitAccusation() {
            if (selectedSuspect === null) {
                alert('å®¹ç–‘è€…ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚');
                return;
            }

            // Save the selected suspect before closing modal
            const accusedIndex = selectedSuspect;
            closeAccusationModal();
            showResult(accusedIndex === murdererId, accusedIndex);
        }

        function showResult(isCorrect, accusedIndex) {
            console.log('showResult called:', isCorrect, 'accusedIndex:', accusedIndex);
            document.getElementById('gameScreen').style.display = 'none';
            const resultScreen = document.getElementById('resultScreen');
            resultScreen.style.display = 'block';

            if (isCorrect) {
                // Play clear BGM on success
                playBGM('clear', true);
                resultScreen.innerHTML = `
                    <div class="intro-screen">
                        <h2 class="result-title success">äº‹ä»¶è§£æ±º</h2>
                        <div class="explanation">
                            <p style="font-size: 1.2em; text-align: center; margin-bottom: 30px;">
                                çŠ¯äººã¯<strong style="color: var(--accent-gold);">ç”°ä¸­å¥å¤ª</strong>ã§ã—ãŸã€‚
                            </p>

                            <h3>çœŸç›¸</h3>
                            <p>ç”°ä¸­ã¯é›»è©±ä¼šè­°ã®ã‚¢ãƒªãƒã‚¤ãŒã‚ã‚‹ã‚ˆã†ã«è¦‹ãˆã¾ã—ãŸãŒã€å®Ÿã¯ã“ã‚ŒãŒãƒˆãƒªãƒƒã‚¯ã§ã—ãŸã€‚</p>

                            <div class="timeline">
                                <div class="timeline-item">
                                    <strong>10:15</strong> - ç›¸æ¾¤ã¨ã®ä¼šè­°ãŒçµ‚äº†ã€‚ç”°ä¸­ã¯æ›¸æ–ã‚’å‡ºã‚‹ã€‚
                                </div>
                                <div class="timeline-item">
                                    <strong>10:17</strong> - ã‚²ã‚¹ãƒˆãƒ«ãƒ¼ãƒ ã§é›»è©±ä¼šè­°ã‚’é–‹å§‹ã€‚ã—ã‹ã—ã“ã‚Œã¯äº‹å‰ã«éŒ²ç”»ã—ãŸè‡ªåˆ†ã®æ˜ åƒã‚’æµã—ã¦ã„ãŸã€‚
                                </div>
                                <div class="timeline-item">
                                    <strong>10:20</strong> - èª°ã‚‚ã„ãªã„éš™ã«æ›¸æ–ã¸æˆ»ã‚Šã€ç›¸æ¾¤ã‚’è¥²æ’ƒã€‚å‡¶å™¨ï¼ˆé‡ã„é‡‘å±è£½ã®ãƒ–ãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼‰ã§å¾Œé ­éƒ¨ã‚’æ®´æ‰“ã€‚
                                </div>
                                <div class="timeline-item">
                                    <strong>10:25</strong> - å‡¶å™¨ã‚’ãƒãƒ«ã‚³ãƒ‹ãƒ¼ã®æ¤æœ¨é‰¢ã®åœŸã®ä¸­ã«éš ã™ï¼ˆã¾ã ç™ºè¦‹ã•ã‚Œã¦ã„ãªã„ï¼‰ã€‚
                                </div>
                                <div class="timeline-item">
                                    <strong>10:49</strong> - é›»è©±ä¼šè­°ã®éŒ²ç”»ãŒçµ‚ã‚ã‚‹ç›´å‰ã«ã‚­ãƒƒãƒãƒ³ã¸ç§»å‹•ã—ã€ã‚³ãƒ¼ãƒ’ãƒ¼ã‚’æ·¹ã‚Œã‚‹ã€‚
                                </div>
                                <div class="timeline-item">
                                    <strong>10:50</strong> - æ°´é‡ã«å§¿ã‚’è¦‹ã›ã€ã‚¢ãƒªãƒã‚¤å·¥ä½œã€‚ãã®å¾Œã€ä¼šè­°ã«ã€Œæˆ»ã‚‹ã€ã€‚
                                </div>
                            </div>

                            <h3>æ±ºå®šçš„ãªçŸ›ç›¾</h3>
                            <p>ç”°ä¸­ã®é›»è©±ä¼šè­°è¨˜éŒ²ã¯ç¢ºã‹ã«å­˜åœ¨ã—ã¾ã™ãŒã€ã‚ˆãèª¿ã¹ã‚‹ã¨ä»¥ä¸‹ã®çŸ›ç›¾ãŒã‚ã‚Šã¾ã—ãŸ:</p>
                            <ul style="margin-left: 30px; line-height: 2;">
                                <li>ä¼šè­°ä¸­ã€ç”°ä¸­ã¯ä¸€åº¦ã‚‚è³ªå•ã«ç­”ãˆã¦ã„ãªã„ï¼ˆéŒ²ç”»ã ã£ãŸãŸã‚ï¼‰</li>
                                <li>ä¼šè­°ã®å‚åŠ è€…ãŒã€Œç”°ä¸­ã•ã‚“ã€èã“ãˆã¦ã„ã¾ã™ã‹?ã€ã¨ä½•åº¦ã‚‚å‘¼ã³ã‹ã‘ã¦ã„ã‚‹éŸ³å£°è¨˜éŒ²</li>
                                <li>ãƒ“ãƒ‡ã‚ªä¼šè­°ã®ãƒ­ã‚°ã‚’è©³ç´°ã«åˆ†æã™ã‚‹ã¨ã€èƒŒæ™¯ãŒ10:20ã€œ10:48ã®é–“ã€å®Œå…¨ã«é™æ­¢ã—ã¦ã„ã‚‹</li>
                                <li>é€šå¸¸ã®ä¼šè­°ã§ã¯ä½“ã®æºã‚Œã‚„å°ã•ãªå‹•ããŒã‚ã‚‹ãŒã€ã“ã®æ™‚é–“å¸¯ã¯ä¸è‡ªç„¶ãªã»ã©é™æ­¢</li>
                            </ul>

                            <h3>å‹•æ©Ÿ</h3>
                            <p>ç›¸æ¾¤ã®ç„¡è¬€ãªæŠ•è³‡ã«ã‚ˆã‚Šã€ç”°ä¸­ãŒ20å¹´ã‹ã‘ã¦ç¯‰ã„ãŸä¼šç¤¾ãŒå´©å£Šå¯¸å‰ã§ã—ãŸã€‚ç›¸æ¾¤ã‚’èª¬å¾—ã™ã‚‹ã“ã¨ã¯ä¸å¯èƒ½ã§ã€æ ªå¼ã®éåŠæ•°ã‚’æŒã¤ç›¸æ¾¤ã‚’æ’é™¤ã™ã‚‹ä»¥å¤–ã«ä¼šç¤¾ã‚’æ•‘ã†æ–¹æ³•ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</p>

                            <h3>ãã®ä»–ã®å®¹ç–‘è€…ã«ã¤ã„ã¦</h3>
                            <p><strong>æ°´é‡ç¾å’²:</strong> 10:32ã€œ10:58ã®PCç·¨é›†å±¥æ­´ã«ã‚ˆã‚Šã€æ›¸æ–ã«ã¯è¡Œã‘ãªã‹ã£ãŸã€‚</p>
                            <p><strong>ç›¸æ¾¤éº»è¡£:</strong> 10:40ã«ã‚­ãƒƒãƒãƒ³ã§ä½è—¤ã¨ä¼šã£ã¦ãŠã‚Šã€ãã‚Œã¾ã§è‡ªå®¤ã«ã„ãŸå¯èƒ½æ€§ãŒé«˜ã„ã€‚</p>
                            <p><strong>ä½è—¤å„ªå­:</strong> 10:15ã«æ°´é‡ãŒæ›¸æ–ã‚’å‡ºã‚‹ã®ã‚’ç›®æ’ƒã—ã¦ãŠã‚Šã€10:40ã¾ã§å±…é–“ã«ã„ãŸã€‚</p>
                            <p><strong>å±±æœ¬å¤§è¼”:</strong> ãƒãƒ«ã‚³ãƒ‹ãƒ¼ã®å¸ã„æ®»ã¨è¨¼è¨€ãŒä¸€è‡´ã€‚æ›¸æ–ã‹ã‚‰ã¯é ãã€ç‰©ç†çš„ã«ä¸å¯èƒ½ã€‚</p>
                        </div>

                        <button class="start-btn" onclick="location.reload()">ã‚‚ã†ä¸€åº¦ãƒ—ãƒ¬ã‚¤</button>
                    </div>
                `;
            } else {
                // Return to default BGM on failure
                playBGM('default', true);

                const accused = suspects[accusedIndex];
                console.log('Failure case - accused:', accused, 'index:', accusedIndex);
                const reasonHTML = getInnocenceReason(accusedIndex);
                console.log('Reason HTML:', reasonHTML);

                resultScreen.innerHTML = `
                    <div class="intro-screen">
                        <h2 class="result-title failure">èª¤èªé€®æ•</h2>
                        <div class="explanation">
                            <p style="font-size: 1.2em; text-align: center; margin-bottom: 30px; color: var(--accent-red);">
                                <strong>${accused.name}</strong>ã¯çŠ¯äººã§ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚
                            </p>

                            <h3>${accused.name}ãŒçŠ¯äººã§ã¯ãªã„ç†ç”±</h3>
                            ${getInnocenceReason(accusedIndex)}

                            <p style="margin-top: 30px; color: var(--text-dim);">
                                ã‚‚ã†ä¸€åº¦ã€å…¨ã¦ã®è¨¼æ‹ ã¨è¨¼è¨€ã‚’æ³¨æ„æ·±ãæ¤œè¨¼ã—ã¦ã¿ã¦ãã ã•ã„ã€‚çœŸå®Ÿã¯ç´°éƒ¨ã«éš ã‚Œã¦ã„ã¾ã™ã€‚
                            </p>

                            <div style="background: rgba(139, 0, 0, 0.2); border: 2px solid var(--accent-red); border-radius: 10px; padding: 25px; margin-top: 30px; text-align: center;">
                                <p style="font-size: 1.1em; font-weight: 600; margin-bottom: 15px; color: var(--accent-red);">
                                    æœæŸ»å¤±æ•—
                                </p>
                                <p style="line-height: 1.8; margin-bottom: 0;">
                                    èª¤ã£ãŸå‘Šç™ºã«ã‚ˆã‚Šã€çœŸçŠ¯äººã«é€ƒèµ°ã®æ™‚é–“ã‚’ä¸ãˆã¦ã—ã¾ã£ãŸã€‚<br>
                                    äº‹ä»¶ã¯è¿·å®®å…¥ã‚Šã¨ãªã‚Šã€ç›¸æ¾¤éš†ä¸€ã®æ­»ã®çœŸç›¸ã¯é—‡ã«è‘¬ã‚‰ã‚Œã‚‹ã“ã¨ã¨ãªã‚‹...
                                </p>
                            </div>
                        </div>

                        <div style="display: flex; gap: 20px; justify-content: center; margin-top: 30px;">
                            <button class="start-btn" onclick="returnToHome()" style="background: linear-gradient(135deg, var(--border-color) 0%, var(--secondary-dark) 100%);">
                                ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹
                            </button>
                            <button class="start-btn" onclick="location.reload()">
                                ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ã™ã‚‹
                            </button>
                        </div>
                    </div>
                `;
            }
        }

        function returnToHome() {
            // Stop all BGM
            stopAllBGM();

            // Show intro screen
            document.getElementById('resultScreen').style.display = 'none';
            document.getElementById('gameScreen').style.display = 'none';
            document.getElementById('introScreen').style.display = 'block';

            // Reset game state
            collectedEvidence = [];
            selectedSuspect = null;
            currentSuspect = 0;
        }

        function getInnocenceReason(suspectIndex) {
            console.log('getInnocenceReason called with index:', suspectIndex);
            const reasons = [
                `<p>æ°´é‡ç¾å’²ã«ã¯ã‚¢ãƒªãƒã‚¤ãŒã‚ã‚Šã¾ã™ã€‚10æ™‚32åˆ†ã‹ã‚‰10æ™‚58åˆ†ã¾ã§ã€PCã§ç¶™ç¶šçš„ã«æ›¸é¡ã‚’ç·¨é›†ã—ã¦ã„ãŸè¨˜éŒ²ãŒã‚ã‚Šã¾ã™ã€‚æ¨å®šæ­»äº¡æ™‚åˆ»ï¼ˆ10:30ã€œ11:00ï¼‰ã®é–‹å§‹æ™‚ç‚¹ã§ã¯ã€å½¼å¥³ã¯ãƒªãƒ“ãƒ³ã‚°ã§PCä½œæ¥­ã‚’ã—ã¦ãŠã‚Šã€ç‰©ç†çš„ã«çŠ¯è¡Œã¯ä¸å¯èƒ½ã§ã™ã€‚</p>`,
                `<p>ç›¸æ¾¤éº»è¡£ã¯10æ™‚40åˆ†ã«ã‚­ãƒƒãƒãƒ³ã§ä½è—¤å„ªå­ã¨é­é‡ã—ã¦ã„ã¾ã™ã€‚ãã‚Œã¾ã§è‡ªå®¤ã«ã„ãŸã¨ã„ã†è¨¼è¨€ã¨ã€ãƒ¯ã‚¤ãƒ³ã‚°ãƒ©ã‚¹ã®è¨¼æ‹ ã‹ã‚‰ã€çŠ¯è¡Œæ™‚åˆ»ã«æ›¸æ–ã«ã„ãŸå¯èƒ½æ€§ã¯ä½ã„ã§ã™ã€‚ã¾ãŸã€å½¼å¥³ã«ã¯è‡ªåˆ†ã®äº‹æ¥­ãŒã‚ã‚Šã€è²¡ç”£ç›®å½“ã¦ã¨ã„ã†å‹•æ©Ÿã‚‚å¼±ã„ã§ã™ã€‚</p>`,
                null, // ç”°ä¸­ï¼ˆçœŸçŠ¯äººï¼‰
                `<p>ä½è—¤å„ªå­ã¯10æ™‚15åˆ†é ƒã«å»Šä¸‹ã§æ°´é‡ãŒæ›¸æ–ã‹ã‚‰å‡ºã¦ãã‚‹ã®ã‚’ç›®æ’ƒã—ã¦ãŠã‚Šã€ãã®å¾Œãƒªãƒ“ãƒ³ã‚°ã«ç§»å‹•ã€‚10æ™‚40åˆ†ã«ã¯ã‚­ãƒƒãƒãƒ³ã§éº»è¡£ã¨é­é‡ã—ã¦ã„ã¾ã™ã€‚ã“ã®é–“ã€æ›¸æ–ã«å…¥ã‚‹æ©Ÿä¼šã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</p>`,
                `<p>å±±æœ¬å¤§è¼”ã¯10æ™‚ã‹ã‚‰10æ™‚30åˆ†ã¾ã§ãƒãƒ«ã‚³ãƒ‹ãƒ¼ã§ã‚¿ãƒã‚³ã‚’å¸ã£ã¦ã„ã¾ã—ãŸã€‚ãƒãƒ«ã‚³ãƒ‹ãƒ¼ã®ç°çš¿ã«ã¯æ–°ã—ã„å¸ã„æ®»ãŒ3æœ¬ã‚ã‚Šã€è¨¼è¨€ã¨ä¸€è‡´ã—ã¾ã™ã€‚ãƒãƒ«ã‚³ãƒ‹ãƒ¼ã¯æ›¸æ–ã®åå¯¾å´ã«ã‚ã‚Šã€ç‰©ç†çš„ã«çŠ¯è¡Œã¯å›°é›£ã§ã™ã€‚</p>`
            ];

            const result = reasons[suspectIndex] || '<p>è¨¼æ‹ ãŒä¸ååˆ†ã§ã™ã€‚</p>';
            console.log('Returning reason:', result);
            return result;
        }
    </script>
</body>
</html>