<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ±äº¬ãƒŸãƒƒãƒ‰ãƒŠã‚¤ãƒˆæ®ºäººäº‹ä»¶</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&family=Noto+Serif+JP:wght@400;600&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-dark: #0a0e27;
            --secondary-dark: #1a1f3a;
            --accent-gold: #d4af37;
            --accent-red: #8b0000;
            --text-light: #e8e8e8;
            --text-dim: #a0a0a0;
            --border-color: #2a2f4a;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--secondary-dark) 100%);
            color: var(--text-light);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .background-pattern {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image:
                repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(255,255,255,.03) 2px, rgba(255,255,255,.03) 4px),
                repeating-linear-gradient(90deg, transparent, transparent 2px, rgba(255,255,255,.03) 2px, rgba(255,255,255,.03) 4px);
            pointer-events: none;
            z-index: 1;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 2;
        }

        header {
            text-align: center;
            padding: 40px 20px;
            border-bottom: 2px solid var(--accent-gold);
            margin-bottom: 40px;
            background: rgba(26, 31, 58, 0.6);
            backdrop-filter: blur(10px);
            border-radius: 10px;
        }

        h1 {
            font-family: 'Noto Serif JP', serif;
            font-size: 3em;
            font-weight: 600;
            color: var(--accent-gold);
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            letter-spacing: 0.1em;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.1em;
            color: var(--text-dim);
            letter-spacing: 0.2em;
        }

        .intro-screen, .game-screen {
            background: rgba(26, 31, 58, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 40px;
            border: 1px solid var(--border-color);
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }

        .intro-content {
            max-width: 800px;
            margin: 0 auto;
            line-height: 2;
        }

        .intro-content p {
            margin-bottom: 20px;
            font-size: 1.1em;
        }

        .victim-info {
            background: rgba(139, 0, 0, 0.2);
            border-left: 4px solid var(--accent-red);
            padding: 20px;
            margin: 30px 0;
            border-radius: 5px;
        }

        .start-btn {
            display: block;
            margin: 40px auto 0;
            padding: 15px 60px;
            background: linear-gradient(135deg, var(--accent-gold) 0%, #b8941f 100%);
            color: var(--primary-dark);
            border: none;
            border-radius: 50px;
            font-size: 1.2em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            font-family: 'Noto Sans JP', sans-serif;
        }

        .start-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(212, 175, 55, 0.4);
        }

        .game-screen {
            display: none;
        }

        .suspects-panel {
            background: rgba(10, 14, 39, 0.6);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid var(--border-color);
            margin-bottom: 20px;
        }

        .suspects-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .suspect-card {
            background: rgba(26, 31, 58, 0.8);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .suspect-card:hover {
            border-color: var(--accent-gold);
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3);
        }

        .suspect-card.active {
            border-color: var(--accent-gold);
            background: rgba(212, 175, 55, 0.1);
        }

        .suspect-card.info-card {
            background: rgba(42, 47, 74, 0.9);
            border-color: rgba(100, 150, 255, 0.5);
        }

        .suspect-card.info-card:hover {
            border-color: rgba(100, 150, 255, 0.8);
            box-shadow: 0 4px 12px rgba(100, 150, 255, 0.3);
        }

        .suspect-card.info-card.active {
            border-color: rgba(100, 150, 255, 1);
            background: rgba(100, 150, 255, 0.15);
        }

        .suspect-card.accusation-card {
            background: rgba(139, 0, 0, 0.3);
            border-color: var(--accent-red);
        }

        .suspect-card.accusation-card:hover {
            border-color: var(--accent-red);
            box-shadow: 0 4px 12px rgba(139, 0, 0, 0.5);
        }

        .suspect-card.accusation-card .suspect-name {
            color: var(--accent-red);
        }

        .suspect-name {
            font-size: 1em;
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--accent-gold);
        }

        .suspect-role {
            font-size: 0.85em;
            color: var(--text-dim);
        }

        .game-layout {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 20px;
        }

        .main-panel {
            background: rgba(10, 14, 39, 0.6);
            border-radius: 10px;
            padding: 30px;
            border: 1px solid var(--border-color);
        }

        .right-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .evidence-panel {
            background: rgba(10, 14, 39, 0.6);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid var(--border-color);
            overflow-y: auto;
            flex: 1;
        }

        .panel-title {
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--accent-gold);
            color: var(--accent-gold);
        }

        .suspect-detail {
            display: none;
        }

        .suspect-detail.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .detail-section {
            margin-bottom: 30px;
        }

        .detail-section h3 {
            color: var(--accent-gold);
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .detail-section p, .detail-section li {
            line-height: 1.8;
            margin-bottom: 10px;
        }

        .alibi-box {
            background: rgba(26, 31, 58, 0.6);
            border-left: 3px solid var(--accent-gold);
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .question-btn {
            background: rgba(212, 175, 55, 0.2);
            border: 1px solid var(--accent-gold);
            color: var(--text-light);
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
            font-family: 'Noto Sans JP', sans-serif;
        }

        .question-btn:hover {
            background: rgba(212, 175, 55, 0.3);
        }

        .question-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .answer-box {
            background: rgba(26, 31, 58, 0.8);
            border-left: 3px solid var(--accent-red);
            padding: 15px;
            margin-top: 10px;
            border-radius: 5px;
            display: none;
        }

        .answer-box.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .evidence-item {
            background: rgba(26, 31, 58, 0.8);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .evidence-item.new {
            border-color: var(--accent-gold);
            animation: pulse 2s ease;
        }

        @keyframes pulse {
            0%, 100% { border-color: var(--accent-gold); }
            50% { border-color: var(--accent-red); }
        }

        .evidence-title {
            color: var(--accent-gold);
            font-weight: 600;
            margin-bottom: 10px;
        }

        .accusation-panel {
            background: rgba(139, 0, 0, 0.2);
            border: 2px solid var(--accent-red);
            border-radius: 10px;
            padding: 20px;
        }

        .accusation-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, var(--accent-red) 0%, #660000 100%);
            color: var(--text-light);
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Noto Sans JP', sans-serif;
        }

        .accusation-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139, 0, 0, 0.4);
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: linear-gradient(135deg, var(--secondary-dark) 0%, var(--primary-dark) 100%);
            margin: 5vh auto;
            padding: 40px;
            border: 2px solid var(--accent-gold);
            border-radius: 15px;
            width: 95%;
            max-width: 1100px;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 10px 50px rgba(0,0,0,0.5);
        }

        #suspectOptions {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 30px;
        }

        .close {
            color: var(--text-dim);
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close:hover {
            color: var(--accent-gold);
        }

        .suspect-option {
            background: rgba(26, 31, 58, 0.8);
            border: 2px solid var(--border-color);
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .suspect-option:hover {
            border-color: var(--accent-gold);
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(212, 175, 55, 0.3);
        }

        .suspect-option.selected {
            border-color: var(--accent-red);
            background: rgba(139, 0, 0, 0.3);
            box-shadow: 0 8px 20px rgba(139, 0, 0, 0.5);
        }

        .suspect-option-image {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 50%;
            border: 3px solid var(--border-color);
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .suspect-option:hover .suspect-option-image {
            border-color: var(--accent-gold);
        }

        .suspect-option.selected .suspect-option-image {
            border-color: var(--accent-red);
        }

        .suspect-option-name {
            font-size: 1.1em;
            font-weight: 600;
            color: var(--accent-gold);
            margin-bottom: 5px;
        }

        .suspect-option-role {
            font-size: 0.9em;
            color: var(--text-dim);
        }

        .submit-accusation {
            display: block;
            margin: 30px auto 0;
            padding: 15px 40px;
            background: linear-gradient(135deg, var(--accent-gold) 0%, #b8941f 100%);
            color: var(--primary-dark);
            border: none;
            border-radius: 50px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Noto Sans JP', sans-serif;
        }

        .submit-accusation:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(212, 175, 55, 0.4);
        }

        .result-screen {
            display: none;
            text-align: center;
            background: rgba(26, 31, 58, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 40px;
            border: 1px solid var(--border-color);
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }

        .result-screen.active {
            display: block;
        }

        .result-title {
            font-family: 'Noto Serif JP', serif;
            font-size: 2.5em;
            margin-bottom: 30px;
        }

        .result-title.success {
            color: var(--accent-gold);
        }

        .result-title.failure {
            color: var(--accent-red);
        }

        .explanation {
            background: rgba(26, 31, 58, 0.8);
            border-radius: 10px;
            padding: 30px;
            margin: 30px 0;
            text-align: left;
            line-height: 2;
        }

        .explanation h3 {
            color: var(--accent-gold);
            margin: 20px 0 10px 0;
        }

        .timeline {
            background: rgba(10, 14, 39, 0.6);
            border-left: 3px solid var(--accent-gold);
            padding: 20px;
            margin: 20px 0;
        }

        .timeline-item {
            margin-bottom: 15px;
            padding-left: 20px;
            border-left: 2px solid var(--text-dim);
        }

        .scrollbar::-webkit-scrollbar {
            width: 8px;
        }

        .scrollbar::-webkit-scrollbar-track {
            background: rgba(26, 31, 58, 0.5);
            border-radius: 4px;
        }

        .scrollbar::-webkit-scrollbar-thumb {
            background: var(--accent-gold);
            border-radius: 4px;
        }

        .scrollbar::-webkit-scrollbar-thumb:hover {
            background: #b8941f;
        }

        .character-portrait {
            width: 250px;
            height: auto;
            min-height: 200px;
            max-height: 350px;
            object-fit: cover;
            border-radius: 10px;
            border: 3px solid var(--accent-gold);
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
            flex-shrink: 0;
        }

        .suspect-header {
            display: flex;
            gap: 30px;
            margin-bottom: 30px;
            align-items: stretch;
        }

        .suspect-header-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .suspect-header-info h2 {
            color: var(--accent-gold);
            margin-bottom: 20px;
            font-size: 2em;
        }

        .suspect-header-section {
            margin-bottom: 15px;
        }

        .suspect-header-section:last-child {
            margin-bottom: 0;
        }

        .suspect-header-section h3 {
            color: var(--accent-gold);
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .suspect-header-section p {
            line-height: 1.8;
        }

        /* BGM Control Panel */
        .bgm-control {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: rgba(26, 31, 58, 0.95);
            backdrop-filter: blur(10px);
            border: 2px solid var(--border-color);
            border-radius: 15px;
            padding: 15px;
            z-index: 999;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
        }

        .bgm-control.collapsed {
            min-width: auto;
        }

        .bgm-control.expanded {
            min-width: 280px;
        }

        .bgm-control:hover {
            border-color: var(--accent-gold);
        }

        .bgm-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            user-select: none;
        }

        .bgm-title {
            font-size: 0.9em;
            color: var(--accent-gold);
            font-weight: 600;
            letter-spacing: 0.05em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .bgm-toggle-icon {
            font-size: 0.8em;
            transition: transform 0.3s ease;
        }

        .bgm-control.expanded .bgm-toggle-icon {
            transform: rotate(180deg);
        }

        .bgm-now-playing {
            font-size: 0.85em;
            color: var(--text-dim);
            margin-top: 10px;
            font-style: italic;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .bgm-control.collapsed .bgm-now-playing {
            max-height: 0;
            margin-top: 0;
            opacity: 0;
        }

        .bgm-controls {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--border-color);
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .bgm-control.collapsed .bgm-controls {
            max-height: 0;
            margin-top: 0;
            padding-top: 0;
            opacity: 0;
        }

        .bgm-mute-btn {
            background: rgba(212, 175, 55, 0.2);
            border: 1px solid var(--accent-gold);
            color: var(--accent-gold);
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Noto Sans JP', sans-serif;
            font-size: 0.9em;
            white-space: nowrap;
        }

        .bgm-mute-btn:hover {
            background: rgba(212, 175, 55, 0.3);
            transform: translateY(-1px);
        }

        .bgm-mute-btn.muted {
            background: rgba(139, 0, 0, 0.3);
            border-color: var(--accent-red);
            color: var(--accent-red);
        }

        .volume-control {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .volume-slider {
            flex: 1;
            -webkit-appearance: none;
            appearance: none;
            height: 6px;
            background: rgba(42, 47, 74, 0.8);
            border-radius: 3px;
            outline: none;
        }

        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            background: var(--accent-gold);
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .volume-slider::-webkit-slider-thumb:hover {
            background: #b8941f;
            transform: scale(1.2);
        }

        .volume-slider::-moz-range-thumb {
            width: 16px;
            height: 16px;
            background: var(--accent-gold);
            border-radius: 50%;
            cursor: pointer;
            border: none;
            transition: all 0.3s ease;
        }

        .volume-slider::-moz-range-thumb:hover {
            background: #b8941f;
            transform: scale(1.2);
        }

        .volume-label {
            font-size: 0.85em;
            color: var(--text-dim);
            min-width: 35px;
            text-align: right;
        }

        .floor-plan-container {
            background: rgba(26, 31, 58, 0.8);
            border-radius: 10px;
            padding: 30px;
            margin: 20px 0;
            text-align: center;
        }

        .floor-plan-title {
            color: var(--accent-gold);
            font-size: 1.5em;
            margin-bottom: 30px;
        }

        .floor-plan {
            display: inline-block;
            border: 3px solid var(--accent-gold);
            background: rgba(10, 14, 39, 0.9);
            padding: 30px;
            border-radius: 10px;
        }

        .floor-row {
            display: flex;
            align-items: stretch;
            margin-bottom: 0;
        }

        .room {
            border: 2px solid var(--border-color);
            padding: 20px;
            min-width: 150px;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: rgba(20, 25, 45, 0.9);
            position: relative;
        }

        .room-name {
            font-weight: 600;
            color: var(--accent-gold);
            margin-bottom: 5px;
            font-size: 1.1em;
        }

        .room-detail {
            font-size: 0.85em;
            color: var(--text-dim);
            text-align: center;
        }

        .room.crime-scene {
            background: rgba(139, 0, 0, 0.2);
            border-color: var(--accent-red);
        }

        .room.crime-scene .room-name {
            color: var(--accent-red);
        }

        .room.hallway {
            background: rgba(100, 150, 255, 0.1);
            border-color: rgba(100, 150, 255, 0.4);
            min-width: 100px;
        }

        .vertical-room {
            writing-mode: vertical-rl;
            text-orientation: mixed;
        }

        .restart-btn {
            display: block;
            margin: 30px auto 0;
            padding: 15px 40px;
            background: linear-gradient(135deg, var(--accent-gold) 0%, #b8941f 100%);
            color: var(--primary-dark);
            border: none;
            border-radius: 50px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Noto Sans JP', sans-serif;
        }

        .restart-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(212, 175, 55, 0.4);
        }

        /* ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆå¯¾å¿œ */
        @media (max-width: 1200px) {
            .game-layout {
                grid-template-columns: 1fr;
            }

            .suspects-grid {
                grid-template-columns: repeat(4, 1fr);
            }

            h1 {
                font-size: 2em;
            }

            .bgm-control {
                bottom: 15px;
                right: 15px;
                padding: 12px;
            }

            .bgm-control.expanded {
                min-width: 250px;
            }

            #suspectOptions {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆç¸¦ */
        @media (max-width: 900px) {
            .suspects-grid {
                grid-template-columns: repeat(3, 1fr);
            }

            .container {
                padding: 15px;
            }

            header {
                padding: 25px 15px;
                margin-bottom: 25px;
            }

            .intro-screen, .game-screen {
                padding: 25px;
            }

            .main-panel {
                padding: 20px;
            }
        }

        /* ã‚¹ãƒãƒ›æ¨ªãƒ»å°ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆ */
        @media (max-width: 768px) {
            .suspects-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .suspect-header {
                flex-direction: column;
            }

            .character-portrait {
                width: 180px;
                height: auto;
                max-height: 250px;
                margin: 0 auto;
            }

            #suspectOptions {
                grid-template-columns: repeat(2, 1fr);
            }

            h1 {
                font-size: 1.6em;
                letter-spacing: 0.05em;
            }

            .subtitle {
                font-size: 0.9em;
            }

            .panel-title {
                font-size: 1.1em;
            }

            .suspect-name {
                font-size: 0.9em;
            }

            .suspect-role {
                font-size: 0.75em;
            }

            .question-btn {
                padding: 12px 15px;
                font-size: 0.9em;
                width: 100%;
                margin: 5px 0;
            }

            .floor-plan {
                padding: 15px;
                overflow-x: auto;
            }

            .room {
                min-width: 100px;
                min-height: 70px;
                padding: 10px;
            }

            .room-name {
                font-size: 0.9em;
            }

            .room-detail {
                font-size: 0.75em;
            }
        }

        /* ã‚¹ãƒãƒ›ç¸¦ */
        @media (max-width: 480px) {
            .container {
                padding: 10px;
            }

            header {
                padding: 20px 10px;
                margin-bottom: 20px;
                border-radius: 8px;
            }

            h1 {
                font-size: 1.3em;
            }

            .subtitle {
                font-size: 0.8em;
                letter-spacing: 0.1em;
            }

            .intro-screen, .game-screen {
                padding: 15px;
                border-radius: 10px;
            }

            .intro-content p {
                font-size: 0.95em;
                line-height: 1.8;
            }

            .victim-info {
                padding: 15px;
                font-size: 0.9em;
            }

            .victim-info p {
                margin-bottom: 8px;
            }

            .start-btn, .restart-btn {
                padding: 12px 40px;
                font-size: 1em;
            }

            .suspects-panel {
                padding: 15px;
            }

            .suspects-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }

            .suspect-card {
                padding: 12px 8px;
            }

            .suspect-name {
                font-size: 0.85em;
            }

            .suspect-role {
                font-size: 0.7em;
            }

            .main-panel {
                padding: 15px;
            }

            .suspect-header {
                gap: 15px;
                margin-bottom: 20px;
            }

            .character-portrait {
                width: 150px;
                max-height: 200px;
            }

            .suspect-header-info h2 {
                font-size: 1.4em;
                margin-bottom: 15px;
            }

            .suspect-header-section h3 {
                font-size: 1em;
            }

            .suspect-header-section p {
                font-size: 0.9em;
                line-height: 1.6;
            }

            .detail-section {
                margin-bottom: 20px;
            }

            .detail-section h3 {
                font-size: 1em;
                margin-bottom: 10px;
            }

            .alibi-box {
                padding: 12px;
                font-size: 0.9em;
            }

            .evidence-panel {
                padding: 15px;
            }

            .evidence-item {
                padding: 12px;
                font-size: 0.9em;
            }

            .evidence-title {
                font-size: 0.95em;
            }

            /* ãƒ¢ãƒ¼ãƒ€ãƒ« ã‚¹ãƒãƒ›å¯¾å¿œ */
            .modal-content {
                margin: 2vh auto;
                padding: 20px;
                width: 95%;
                max-height: 90vh;
            }

            .modal-content h2 {
                font-size: 1.2em;
            }

            #suspectOptions {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }

            .suspect-option {
                padding: 10px;
            }

            .suspect-option-image {
                width: 70px;
                height: 70px;
                margin-bottom: 10px;
            }

            .suspect-option-name {
                font-size: 0.9em;
            }

            .suspect-option-role {
                font-size: 0.75em;
            }

            .submit-accusation {
                padding: 12px 30px;
                font-size: 1em;
            }

            /* çµæœç”»é¢ ã‚¹ãƒãƒ›å¯¾å¿œ */
            .result-screen {
                padding: 20px;
            }

            .result-title {
                font-size: 1.8em;
            }

            .explanation {
                padding: 15px;
                font-size: 0.9em;
                line-height: 1.7;
            }

            .explanation h3 {
                font-size: 1em;
            }

            .timeline {
                padding: 15px;
            }

            .timeline-item {
                font-size: 0.85em;
                padding-left: 15px;
            }

            /* é–“å–ã‚Šå›³ ã‚¹ãƒãƒ›å¯¾å¿œ */
            .floor-plan-container {
                padding: 15px;
                overflow-x: auto;
            }

            .floor-plan {
                padding: 10px;
                transform: scale(0.85);
                transform-origin: top center;
            }

            .room {
                min-width: 80px;
                min-height: 60px;
                padding: 8px;
            }

            .room-name {
                font-size: 0.8em;
            }

            .room-detail {
                font-size: 0.7em;
            }

            /* BGMã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ« ã‚¹ãƒãƒ›å¯¾å¿œ - ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆç‰ˆ */
            .bgm-control {
                bottom: 8px;
                right: 8px;
                padding: 6px 10px;
                border-radius: 10px;
                border-width: 1px;
            }

            .bgm-control.expanded {
                left: auto;
                right: 8px;
                min-width: 180px;
                padding: 8px 12px;
            }

            .bgm-header {
                gap: 6px;
            }

            .bgm-title {
                font-size: 0.7em;
            }

            .bgm-toggle-icon {
                font-size: 0.6em;
            }

            .bgm-now-playing {
                font-size: 0.7em;
                margin-top: 6px;
            }

            .bgm-controls {
                margin-top: 8px;
                padding-top: 8px;
                gap: 8px;
            }

            .bgm-mute-btn {
                padding: 4px 8px;
                font-size: 0.7em;
                border-radius: 5px;
            }

            .volume-control {
                gap: 6px;
            }

            .volume-slider {
                height: 4px;
            }

            .volume-slider::-webkit-slider-thumb {
                width: 12px;
                height: 12px;
            }

            .volume-label {
                font-size: 0.65em;
                min-width: 28px;
            }
        }

        /* éå¸¸ã«å°ã•ã„ã‚¹ãƒãƒ› */
        @media (max-width: 360px) {
            h1 {
                font-size: 1.1em;
            }

            .suspects-grid {
                grid-template-columns: 1fr 1fr;
                gap: 8px;
            }

            .suspect-card {
                padding: 10px 6px;
            }

            .character-portrait {
                width: 120px;
            }

            #suspectOptions {
                grid-template-columns: 1fr 1fr;
            }

            .suspect-option-image {
                width: 60px;
                height: 60px;
            }
        }
    </style>
</head>
<body>
    <!-- Audio Elements -->
    <audio id="defaultBGM" loop>
        <source src="fukakai-nazo_loop.ogg" type="audio/ogg">
    </audio>
    <audio id="accusationBGM">
        <source src="resolution-or.mp3" type="audio/mpeg">
    </audio>
    <audio id="clearBGM">
        <source src="victory-fanfare.mp3" type="audio/mpeg">
    </audio>

    <!-- BGM Control Panel -->
    <div class="bgm-control collapsed" id="bgmControl">
        <div class="bgm-header" onclick="toggleBGMPanel()">
            <span class="bgm-title">
                â™ª BGM
                <span class="bgm-toggle-icon">â–¼</span>
            </span>
        </div>
        <div class="bgm-now-playing" id="nowPlaying">æ·±æ€ªãªè¬</div>
        <div class="bgm-controls">
            <button class="bgm-mute-btn" id="muteBtn" onclick="toggleMute()">
                <span id="muteText">ğŸ”Š ON</span>
            </button>
            <div class="volume-control">
                <input type="range" min="0" max="100" value="50" class="volume-slider" id="volumeSlider">
                <span class="volume-label" id="volumeLabel">50%</span>
            </div>
        </div>
    </div>

    <div class="background-pattern"></div>

    <div class="container">
        <header>
            <h1>æ±äº¬ãƒŸãƒƒãƒ‰ãƒŠã‚¤ãƒˆæ®ºäººäº‹ä»¶</h1>
            <p class="subtitle">TOKYO MIDNIGHT MURDER</p>
        </header>

        <!-- ã‚¤ãƒ³ãƒˆãƒ­ç”»é¢ -->
        <div class="intro-screen" id="introScreen">
            <div class="intro-content">
                <p>2025å¹´11æœˆ23æ—¥æ·±å¤œã€æ±äº¬ãƒ»å…­æœ¬æœ¨ã®é«˜ç´šãƒ›ãƒ†ãƒ«ã€Œã‚°ãƒ©ãƒ³ãƒ‰ãƒ‘ãƒ¬ã‚¹æ±äº¬ã€æœ€ä¸Šéšã®ã‚¹ã‚¤ãƒ¼ãƒˆãƒ«ãƒ¼ãƒ ã§æ®ºäººäº‹ä»¶ãŒç™ºç”Ÿã—ãŸã€‚</p>

                <div class="victim-info">
                    <p><strong>è¢«å®³è€…:</strong> ç›¸æ¾¤éš†ä¸€ï¼ˆ38æ­³ï¼‰ITä¼æ¥­ç¤¾é•·</p>
                    <p><strong>æ­»äº¡æ¨å®šæ™‚åˆ»:</strong> åˆå¾Œ11æ™‚00åˆ†ï¼ˆÂ±3åˆ†ä»¥å†…ï¼‰</p>
                    <p><strong>æ­»å› :</strong> é¦–ã‚’çµã‚ã‚‰ã‚ŒãŸã“ã¨ã«ã‚ˆã‚‹çª’æ¯æ­»</p>
                    <p><strong>å‡¶å™¨:</strong> è¢«å®³è€…ãŒèº«ã«ã¤ã‘ã¦ã„ãŸãƒã‚¯ã‚¿ã‚¤</p>
                    <p><strong>ç™ºè¦‹çŠ¶æ³:</strong> 23:05ã«æ›¸æ–ã§ç§˜æ›¸ã®æ°´é‡ç¾å’²ãŒç™ºè¦‹</p>
                </div>

                <p>ãã®å¤œã€ç›¸æ¾¤ã®ã‚¹ã‚¤ãƒ¼ãƒˆãƒ«ãƒ¼ãƒ ã«ã¯6äººã®äººç‰©ãŒè¨ªã‚ŒãŸã€‚å…¨å“¡ã«å‹•æ©ŸãŒã‚ã‚Šã€å…¨å“¡ã«ã‚¢ãƒªãƒã‚¤ãŒã‚ã‚‹ã€‚</p>
                <p>ã‚ãªãŸã¯åˆ‘äº‹ã¨ã—ã¦ã€è¨¼æ‹ ã‚’é›†ã‚ã€å®¹ç–‘è€…ã‚’å°‹å•ã—ã€çœŸçŠ¯äººã‚’çªãæ­¢ã‚ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚</p>

                <button class="start-btn" onclick="startGame()">æœæŸ»ã‚’é–‹å§‹ã™ã‚‹</button>
            </div>
        </div>

        <!-- ã‚²ãƒ¼ãƒ ç”»é¢ -->
        <div class="game-screen" id="gameScreen">
            <!-- å®¹ç–‘è€…é¸æŠãƒ‘ãƒãƒ« -->
            <div class="suspects-panel">
                <h2 class="panel-title">å®¹ç–‘è€… / æƒ…å ±</h2>
                <div class="suspects-grid" id="suspectsGrid"></div>
            </div>

            <div class="game-layout">
                <!-- ãƒ¡ã‚¤ãƒ³ãƒ‘ãƒãƒ« -->
                <div class="main-panel" id="mainPanel"></div>

                <!-- å³ãƒ‘ãƒãƒ« -->
                <div class="right-panel">
                    <!-- è¨¼æ‹ ãƒ‘ãƒãƒ« -->
                    <div class="evidence-panel scrollbar">
                        <h3 class="panel-title">è¨¼æ‹ å“</h3>
                        <div id="evidenceList"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- çµæœç”»é¢ -->
        <div class="result-screen" id="resultScreen"></div>
    </div>

    <!-- å‘Šç™ºãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="accusationModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeAccusationModal()">&times;</span>
            <h2 style="color: var(--accent-gold); text-align: center; margin-bottom: 20px;">çŠ¯äººã‚’é¸æŠã—ã¦ãã ã•ã„</h2>
            <p style="text-align: center; color: var(--text-dim); margin-bottom: 20px;">
                èª°ãŒçœŸçŠ¯äººã ã¨æ€ã„ã¾ã™ã‹? ä¸€åº¦é¸æŠã™ã‚‹ã¨å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚
            </p>
            <div id="suspectOptions"></div>
            <button class="submit-accusation" onclick="submitAccusation()">ã“ã®äººç‰©ã‚’å‘Šç™ºã™ã‚‹</button>
        </div>
    </div>

    <script>
        // ã‚²ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿
        const suspects = [
            {
                id: "mizuno",
                name: "æ°´é‡ç¾å’²",
                role: "ç§˜æ›¸ãƒ»29æ­³",
                image: "Mizuno.png",
                profile: "ç›¸æ¾¤ã®ç§˜æ›¸ã¨ã—ã¦3å¹´é–“å‹¤å‹™ã€‚æ…¶æ‡‰ç¾©å¡¾å¤§å­¦çµŒæ¸ˆå­¦éƒ¨å’æ¥­å¾Œã€å¤–è³‡ç³»ã‚³ãƒ³ã‚µãƒ«ãƒ†ã‚£ãƒ³ã‚°ä¼šç¤¾ã‚’çµŒã¦ç›¸æ¾¤ã®ç§˜æ›¸ã«ã€‚æœ‰èƒ½ã§ãƒãƒ«ãƒã‚¿ã‚¹ã‚¯ã‚’ã“ãªã™èƒ½åŠ›ã«é•·ã‘ã¦ãŠã‚Šã€ç›¸æ¾¤ã‹ã‚‰çµ¶å¤§ãªä¿¡é ¼ã‚’å¾—ã¦ã„ãŸã€‚ã—ã‹ã—æœ€è¿‘ã¯éåº¦ãªè¦æ±‚ã‚„ç†ä¸å°½ãªæŒ‡ç¤ºã«æ‚©ã¿ã€å¿ƒèº«ã¨ã‚‚ã«ç–²å¼Šã—ã¦ã„ãŸã€‚å‡ å¸³é¢ã§è²¬ä»»æ„ŸãŒå¼·ãã€ä¸€åº¦å¼•ãå—ã‘ãŸä»•äº‹ã¯æœ€å¾Œã¾ã§ã‚„ã‚Šé‚ã’ã‚‹æ€§æ ¼ã€‚",
                motive: "ç›¸æ¾¤ã‹ã‚‰ã®ãƒ‘ãƒ¯ãƒãƒ©ã¨ã‚»ã‚¯ãƒãƒ©ã«é•·å¹´è‹¦ã—ã‚“ã§ã„ãŸã€‚é€€è·ã‚’ç”³ã—å‡ºãŸãŒã€Œæ¥­ç•Œã§åƒã‘ãªãã—ã¦ã‚„ã‚‹ã€ã¨è„…ã•ã‚ŒãŸã€‚ã•ã‚‰ã«ã€è‡ªåˆ†ã®ä¼ç”»ã‚’ç›¸æ¾¤ã«ç›—ç”¨ã•ã‚Œç‰¹è¨±ç”³è«‹ã•ã‚Œã¦ã„ãŸã“ã¨ã‚’çŸ¥ã‚Šã€æ¿€æ€’ã—ã¦ã„ãŸã€‚",
                arrival: "22:00åˆ°ç€",
                alibi: "22:00-22:30ã«æ›¸æ–ã§é¢è«‡ã€‚22:30ã«é€€å®¤ã—ãƒªãƒ“ãƒ³ã‚°ã¸ã€‚22:45-23:00ã¾ã§é»’æœ¨ã€å±±æœ¬ã¨ãƒªãƒ“ãƒ³ã‚°ã§å¾…æ©Ÿã€‚23:00ã«ç›¸æ¾¤ãŒæ›¸æ–ã¸ç§»å‹•å¾Œã‚‚ãƒªãƒ“ãƒ³ã‚°ã§å¾…æ©Ÿã€‚23:05ã«æ›¸æ–ã¸è¡Œãéºä½“ã‚’ç™ºè¦‹ã€‚",
                questions: [
                    {
                        q: "22:30ã®é¢è«‡å¾Œã€ã©ã“ã«ã„ã¾ã—ãŸã‹?",
                        a: "ãƒªãƒ“ãƒ³ã‚°ã«ç§»å‹•ã—ã¦å¾…æ©Ÿã—ã¦ã„ã¾ã—ãŸã€‚é»’æœ¨ã•ã‚“ã¨å±±æœ¬ã•ã‚“ã‚‚ä¸€ç·’ã§ã—ãŸã‹ã‚‰ã€ãšã£ã¨3äººã§ã„ã¾ã—ãŸã‚ˆã€‚",
                        evidence: "é»’æœ¨ã¨å±±æœ¬ã®è¨¼è¨€ã§è£ä»˜ã‘ã‚‰ã‚Œã‚‹ã€‚3äººã¨ã‚‚22:45-23:05ã®é–“ã¯ãƒªãƒ“ãƒ³ã‚°ã«ã„ãŸã€‚"
                    },
                    {
                        q: "23:00-23:05ã®é–“ã€èª°ã‹ãƒªãƒ“ãƒ³ã‚°ã‚’é›¢ã‚Œã¾ã—ãŸã‹?",
                        a: "ç”°ä¸­ã•ã‚“ãŒ23:00éãã«å°‘ã—ã®é–“ã„ãªããªã‚Šã¾ã—ãŸã€‚ãƒˆã‚¤ãƒ¬ã ã¨æ€ã£ã¦ã„ã¾ã—ãŸãŒ...5åˆ†ãã‚‰ã„æˆ»ã£ã¦ã“ãªã‹ã£ãŸã‚ˆã†ãªã€‚",
                        evidence: "é‡è¦ãªè¨¼è¨€ã€‚ç”°ä¸­å¥å¤ªãŒ23:00-23:05ã®é–“ã«ä¸åœ¨ã ã£ãŸã“ã¨ã‚’è¨¼è¨€ã€‚"
                    }
                ]
            },
            {
                id: "aizawa",
                name: "ç›¸æ¾¤éº»è¡£",
                role: "å¦»ãƒ»34æ­³ãƒ»å…ƒãƒ¢ãƒ‡ãƒ«",
                image: "Aizawa.png",
                profile: "ç›¸æ¾¤ã¨çµå©šã—ã¦5å¹´ã€‚å…ƒãƒ¢ãƒ‡ãƒ«ã¨ã—ã¦é›‘èªŒã®è¡¨ç´™ã‚’é£¾ã‚Šä¸€ä¸–ã‚’é¢¨é¡ã—ãŸç¾è²Œã®æŒã¡ä¸»ã€‚ç¾åœ¨ã¯è‡ªèº«ã®ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³ãƒ–ãƒ©ãƒ³ãƒ‰ã€ŒMai Aizawa Collectionã€ã‚’çµŒå–¶ã—ã€å®Ÿæ¥­å®¶ã¨ã—ã¦ã‚‚æˆåŠŸã‚’åã‚ã¦ã„ã‚‹ã€‚ã—ã‹ã—å¤«å©¦ä»²ã¯å†·ãˆåˆ‡ã£ã¦ãŠã‚Šã€å¤«ã®åº¦é‡ãªã‚‹æµ®æ°—ã¨æ¨ªæš´ãªæ…‹åº¦ã«å¿ƒã‚’ç—›ã‚ã¦ã„ãŸã€‚æ°—å“ãŒã‚ã‚Šå†·é™æ²ˆç€ã ãŒã€å†…ã«ç§˜ã‚ãŸæƒ…ç†±ã¯æ¿€ã—ã„ã€‚",
                motive: "å¤«ã®æµ®æ°—ç›¸æ‰‹ãŒä½è—¤å„ªå­ã ã¨çŸ¥ã‚Šã€é›¢å©šã‚’æ±ºæ„ã€‚ã—ã‹ã—å¤«ã¯é›¢å©šã«å¿œã˜ãšã€é€†ã«ã€ŒãŠå‰ã®ä¼šç¤¾ã‚’æ½°ã™ã€ã¨è„…ã—ã¦ã„ãŸã€‚è²¡ç”£åˆ†ä¸ã‚‚ä¸åˆ©ãªæ¡ä»¶ã‚’çªãã¤ã‘ã‚‰ã‚Œã¦ã„ãŸã€‚",
                arrival: "22:15åˆ°ç€",
                alibi: "22:15åˆ°ç€å¾Œã€ãƒªãƒ“ãƒ³ã‚°ã§å¾…æ©Ÿã€‚22:30-23:00ã«æ›¸æ–ã§é¢è«‡ã€‚23:00ã«é€€å®¤å¾Œã€ãã®ã¾ã¾å¸°å®…ã€‚23:05ã«ã‚¿ã‚¯ã‚·ãƒ¼ã§å¸°å®…ä¸­ï¼ˆã‚¿ã‚¯ã‚·ãƒ¼ä¼šç¤¾ã®è¨˜éŒ²ã§ç¢ºèªæ¸ˆã¿ï¼‰ã€‚",
                questions: [
                    {
                        q: "23:00ã«é¢è«‡ãŒçµ‚ã‚ã£ãŸå¾Œã€ã™ãã«å¸°ã‚Šã¾ã—ãŸã‹?",
                        a: "ãˆãˆã€‚ã‚‚ã†å¤«ã¨è©±ã™ã“ã¨ãªã‚“ã¦ä½•ã‚‚ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã‹ã‚‰ã€‚ã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼ã§ã™ãã«1éšã¸é™ã‚Šã¦ã€ã‚¿ã‚¯ã‚·ãƒ¼ã§å¸°ã‚Šã¾ã—ãŸã€‚",
                        evidence: "ã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼è¨˜éŒ²ã§23:01ã«æœ€ä¸Šéšã‹ã‚‰1éšã¸ç§»å‹•ã€‚ã‚¿ã‚¯ã‚·ãƒ¼ä¼šç¤¾ã®è¨˜éŒ²ã§23:05ã«é…è»Šã€23:10ã«è‡ªå®…åˆ°ç€ã€‚å®Œå…¨ãªã‚¢ãƒªãƒã‚¤ã€‚"
                    }
                ]
            },
            {
                id: "tanaka",
                name: "ç”°ä¸­å¥å¤ª",
                role: "ãƒ“ã‚¸ãƒã‚¹ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ãƒ»42æ­³",
                image: "Tanaka.png",
                profile: "ç›¸æ¾¤ã¨å…±åŒã§äº‹æ¥­ã‚’ç«‹ã¡ä¸Šã’ãŸå…±åŒçµŒå–¶è€…ã€‚æ±äº¬å¤§å­¦å·¥å­¦éƒ¨å’æ¥­å¾Œã€å¤§æ‰‹ITä¼æ¥­ã§ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã¨ã—ã¦å‹¤å‹™ã€‚10å¹´å‰ã«ç›¸æ¾¤ã¨æ„æ°—æŠ•åˆã—ã€å…±ã«ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ã‚’å‰µæ¥­ã€‚æŠ€è¡“é¢ã‚’ä¸€æ‰‹ã«æ‹…ã„ã€ä¼šç¤¾ã®æ€¥æˆé•·ã«è²¢çŒ®ã—ã¦ããŸã€‚çœŸé¢ç›®ã§èª å®Ÿãªæ€§æ ¼ã ãŒã€æœ€è¿‘ã¯ç›¸æ¾¤ã®å¼·å¼•ãªçµŒå–¶æ‰‹æ³•ã‚„ä¸æ­£ãªä¼šè¨ˆå‡¦ç†ã«æ‚©ã¾ã•ã‚Œã€ç²¾ç¥çš„ã«è¿½ã„è©°ã‚ã‚‰ã‚Œã¦ã„ãŸã€‚",
                motive: "ç›¸æ¾¤ãŒä¼šç¤¾ã®è³‡é‡‘ã‚’ç§çš„æµç”¨ã—ã€ãã®è²¬ä»»ã‚’ç”°ä¸­ã«æŠ¼ã—ä»˜ã‘ã‚ˆã†ã¨ã—ã¦ã„ãŸã€‚ã“ã®ã¾ã¾ã§ã¯è‡ªåˆ†ãŒåˆ‘å‹™æ‰€è¡Œãã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã£ãŸã€‚ç›¸æ¾¤ã‚’æ¶ˆã›ã°ã€ã™ã¹ã¦ã®è¨¼æ‹ ã‚’éš æ»…ã§ãã‚‹ã€‚",
                arrival: "22:20åˆ°ç€",
                alibi: "22:20åˆ°ç€å¾Œã€ãƒªãƒ“ãƒ³ã‚°ã§å¾…æ©Ÿã€‚23:00-23:30ã®é¢è«‡äºˆå®šã€‚23:00ã«ç›¸æ¾¤ãŒæ›¸æ–ã¸ç§»å‹•å¾Œã‚‚ãƒªãƒ“ãƒ³ã‚°ã§å¾…æ©Ÿã—ã¦ã„ãŸã¨ä¸»å¼µã€‚ã—ã‹ã—ã€è¤‡æ•°ã®è¨¼è¨€ã§23:00-23:05ã®é–“ã«ä¸åœ¨ã ã£ãŸã“ã¨ãŒåˆ¤æ˜ã€‚",
                questions: [
                    {
                        q: "23:00ã‹ã‚‰23:05ã®é–“ã€ã©ã“ã«ã„ã¾ã—ãŸã‹?",
                        a: "ãƒªãƒ“ãƒ³ã‚°ã§å¾…ã£ã¦ã„ã¾ã—ãŸã‚ˆ!ãšã£ã¨!...ã‚ã€ãã†ã„ãˆã°ãƒˆã‚¤ãƒ¬ã«è¡Œã£ãŸã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã§ã‚‚ã€ã™ãæˆ»ã‚Šã¾ã—ãŸ!",
                        evidence: "æ°´é‡ã®è¨¼è¨€:ã€Œç”°ä¸­ã•ã‚“ãŒ23:00éãã«5åˆ†ãã‚‰ã„ã„ãªããªã£ãŸã€ã€‚ä½è—¤ã®è¨¼è¨€:ã€Œç”°ä¸­ã•ã‚“ã®å§¿ãŒè¦‹ãˆãªã„æ™‚é–“ãŒã‚ã£ãŸã€ã€‚é»’æœ¨ã®è¨¼è¨€:ã€Œç”°ä¸­ã•ã‚“ã¯23:03é ƒã«æˆ»ã£ã¦ããŸã€ã€‚"
                    },
                    {
                        q: "ç›¸æ¾¤ã¨ã®é‡‘éŠ­ãƒˆãƒ©ãƒ–ãƒ«ã«ã¤ã„ã¦æ•™ãˆã¦ãã ã•ã„",
                        a: "...ãã‚Œã¯èª¤è§£ã§ã™ã€‚ç¢ºã‹ã«ä¼šè¨ˆã«å•é¡Œã¯ã‚ã‚Šã¾ã—ãŸãŒã€ç§ã¯é–¢ä¿‚ã‚ã‚Šã¾ã›ã‚“ã€‚ç›¸æ¾¤ãŒå‹æ‰‹ã«ã‚„ã£ãŸã“ã¨ã§ã™!",
                        evidence: "ç›¸æ¾¤ã®PCã«ç”°ä¸­ã‚’å‘Šè¨´ã™ã‚‹æº–å‚™æ›¸é¡ã€‚ã€Œä¼šç¤¾è³‡é‡‘æ¨ªé ˜ã®è¨¼æ‹ ã€ã¨ã„ã†ãƒ•ã‚©ãƒ«ãƒ€ã«ç”°ä¸­ã®ç½²åå…¥ã‚Šæ›¸é¡ã€‚"
                    },
                    {
                        q: "ãªãœãƒˆã‚¤ãƒ¬ã«5åˆ†ã‚‚ã‹ã‹ã£ãŸã®ã§ã™ã‹?",
                        a: "ãˆ...ãã®...ä½“èª¿ãŒæ‚ªãã¦...ã€‚ã§ã‚‚ã€æ›¸æ–ã«ã¯è¡Œã£ã¦ã„ã¾ã›ã‚“!",
                        evidence: "ãƒªãƒ“ãƒ³ã‚°ã‹ã‚‰æ›¸æ–ã¾ã§å¾’æ­©20ç§’ã€‚å¾€å¾©40ç§’+çŠ¯è¡Œ3åˆ†=ç´„4åˆ†ã€‚ç”°ä¸­ã®ä¸åœ¨æ™‚é–“ã¨ä¸€è‡´ã€‚"
                    }
                ]
            },
            {
                id: "sato",
                name: "ä½è—¤å„ªå­",
                role: "å…ƒæ‹äººãƒ»31æ­³",
                image: "Sato.png",
                profile: "ç›¸æ¾¤ã®å¤§å­¦æ™‚ä»£ã®æ‹äººã€‚æ—©ç¨²ç”°å¤§å­¦æ–‡å­¦éƒ¨å’æ¥­å¾Œã€å‡ºç‰ˆç¤¾ã§ç·¨é›†è€…ã¨ã—ã¦åƒã„ã¦ã„ã‚‹ã€‚çŸ¥çš„ã§æ„Ÿå—æ€§è±Šã‹ãªæ€§æ ¼ã€‚5å¹´å‰ã«ç›¸æ¾¤ãŒéº»è¡£ã¨çµå©šã—ãŸã“ã¨ã§å¿ƒã‚’ç—›ã‚ãªãŒã‚‰åˆ¥ã‚ŒãŸãŒã€åŠå¹´å‰ã«å¶ç„¶å†ä¼šã—ã€ç›¸æ¾¤ã®ç”˜ã„è¨€è‘‰ã«æƒ‘ã‚ã•ã‚Œå†ã³é–¢ä¿‚ã‚’æŒã¤ã‚ˆã†ã«ãªã£ã¦ã„ãŸã€‚ã—ã‹ã—æ¬¡ç¬¬ã«è‡ªåˆ†ãŒéƒ½åˆã‚ˆãåˆ©ç”¨ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã«æ°—ã¥ãå§‹ã‚ã¦ã„ãŸã€‚",
                motive: "ç›¸æ¾¤ã‹ã‚‰ã€Œã‚‚ã†ä¸€åº¦ã‚„ã‚Šç›´ãã†ã€ã¨è¨€ã‚ã‚Œä¿¡ã˜ã¦ã„ãŸãŒã€å®Ÿã¯éŠã³ã ã£ãŸã¨çŸ¥ã‚‹ã€‚å¦Šå¨ ã‚’å‘Šã’ã‚‹ã¨ã€Œå •ã‚ã›ã€ã•ã‚‚ãªã„ã¨ãŠå‰ã®çµŒæ­´ã‚’æ½°ã™ã€ã¨è„…ã•ã‚ŒãŸã€‚",
                arrival: "22:30åˆ°ç€",
                alibi: "22:30åˆ°ç€å¾Œã€ãƒªãƒ“ãƒ³ã‚°ã§å¾…æ©Ÿã€‚22:45-23:00ã®é–“ã«ç›¸æ¾¤ã¨å£è«–ï¼ˆãƒªãƒ“ãƒ³ã‚°ã§ï¼‰ã€‚23:00ã«ç›¸æ¾¤ãŒæ›¸æ–ã¸ç§»å‹•å¾Œã€ãƒªãƒ“ãƒ³ã‚°ã§é»’æœ¨ã€å±±æœ¬ã€æ°´é‡ã¨å¾…æ©Ÿã€‚23:05ã¾ã§4äººä¸€ç·’ã«ã„ãŸã€‚",
                questions: [
                    {
                        q: "23:00ã‹ã‚‰23:05ã®é–“ã€ãƒªãƒ“ãƒ³ã‚°ã«ã„ã¾ã—ãŸã­?",
                        a: "ã¯ã„ã€‚æ°´é‡ã•ã‚“ã€é»’æœ¨ã•ã‚“ã€å±±æœ¬ã•ã‚“ã¨ä¸€ç·’ã«ã„ã¾ã—ãŸã€‚ç”°ä¸­ã•ã‚“ã ã‘ãŒå°‘ã—ã„ãªããªã‚Šã¾ã—ãŸã‘ã©...ã€‚",
                        evidence: "æ°´é‡ã€é»’æœ¨ã€å±±æœ¬ã®è¨¼è¨€ã¨ä¸€è‡´ã€‚ä½è—¤ã®ã‚¢ãƒªãƒã‚¤ã¯ç¢ºå®Ÿã€‚"
                    }
                ]
            },
            {
                id: "yamamoto",
                name: "å±±æœ¬å¤§è¼”",
                role: "ç¾©å¼Ÿãƒ»33æ­³",
                image: "Yamamoto.png",
                profile: "ç›¸æ¾¤ã®å¦»ãƒ»éº»è¡£ã®å®Ÿå¼Ÿã€‚åœ°æ–¹ã®å¤§å­¦ã‚’å’æ¥­å¾Œã€å§‰ã®å¤«ã§ã‚ã‚‹ç›¸æ¾¤ã®ä¼šç¤¾ã«å…¥ç¤¾ã€‚å–¶æ¥­éƒ¨ã«é…å±ã•ã‚ŒçœŸé¢ç›®ã«åƒã„ã¦ã„ã‚‹ãŒã€ç¾©å…„ã‹ã‚‰ã¯å¸¸ã«èƒ½åŠ›ä¸è¶³ã¨å±è²¬ã•ã‚Œã€æ˜‡é€²ã®æ©Ÿä¼šã‚‚ä¸ãˆã‚‰ã‚Œãšå†·é‡ã•ã‚Œã¦ã„ãŸã€‚å§‰æ€ã„ã§å„ªã—ã„æ€§æ ¼ã ãŒã€ç¾©å…„ã«å¯¾ã—ã¦ã¯è¤‡é›‘ãªæ„Ÿæƒ…ã‚’æŠ±ã„ã¦ã„ã‚‹ã€‚æœ€è¿‘ã¯å§‰ãŒæµ®æ°—ã§è‹¦ã—ã‚“ã§ã„ã‚‹ã“ã¨ã‚’çŸ¥ã‚Šã€ç¾©å…„ã¸ã®æ†¤ã‚ŠãŒå‹Ÿã£ã¦ã„ãŸã€‚",
                motive: "ç›¸æ¾¤ã‹ã‚‰æ—¥å¸¸çš„ã«ãƒ‘ãƒ¯ãƒãƒ©ã‚’å—ã‘ã€çµ¦ä¸ã‚‚ä¸å½“ã«ä½ãæŠ‘ãˆã‚‰ã‚Œã¦ã„ãŸã€‚ã•ã‚‰ã«ã€å§‰ã®éº»è¡£ãŒæµ®æ°—ã§è‹¦ã—ã‚“ã§ã„ã‚‹ã“ã¨ã‚‚çŸ¥ã£ã¦ãŠã‚Šã€ç¾©å…„ã¸ã®æ¨ã¿ã¯é ‚ç‚¹ã«é”ã—ã¦ã„ãŸã€‚",
                arrival: "22:40åˆ°ç€",
                alibi: "22:40åˆ°ç€å¾Œã€ãƒªãƒ“ãƒ³ã‚°ã§å¾…æ©Ÿã€‚23:15-23:45ã®é¢è«‡äºˆå®šã€‚23:00-23:05ã®é–“ã€æ°´é‡ã€é»’æœ¨ã€ä½è—¤ã¨ãƒªãƒ“ãƒ³ã‚°ã§å¾…æ©Ÿã€‚4äººä¸€ç·’ã«ã„ãŸãŸã‚ã€ã‚¢ãƒªãƒã‚¤ã‚ã‚Šã€‚",
                questions: [
                    {
                        q: "23:00ã‹ã‚‰23:05ã®é–“ã®çŠ¶æ³ã‚’æ•™ãˆã¦ãã ã•ã„",
                        a: "ãƒªãƒ“ãƒ³ã‚°ã§å¾…ã£ã¦ã„ã¾ã—ãŸã€‚æ°´é‡ã•ã‚“ã€é»’æœ¨ã•ã‚“ã€ä½è—¤ã•ã‚“ã¨ä¸€ç·’ã§ã™ã€‚ç”°ä¸­ã•ã‚“ã ã‘ãŒé€”ä¸­ã§ã„ãªããªã£ã¦...ãªã‚“ã‹æ§˜å­ãŒãŠã‹ã—ã‹ã£ãŸã§ã™ã€‚",
                        evidence: "ä»–ã®è¨¼è¨€ã¨ä¸€è‡´ã€‚å±±æœ¬ã®ã‚¢ãƒªãƒã‚¤ã¯ç¢ºå®Ÿã€‚"
                    }
                ]
            },
            {
                id: "kuroki",
                name: "é»’æœ¨èª ",
                role: "é¡§å•å¼è­·å£«ãƒ»45æ­³",
                image: "Kuroki2.png",
                profile: "ç›¸æ¾¤ã®ä¼šç¤¾ã®é¡§å•å¼è­·å£«ã¨ã—ã¦10å¹´é–“å‹¤å‹™ã€‚ä¸­å¤®å¤§å­¦æ³•å­¦éƒ¨å’æ¥­å¾Œã€å¤§æ‰‹æ³•å¾‹äº‹å‹™æ‰€ã‚’çµŒã¦ç‹¬ç«‹ã€‚æ³•å¾‹ã®æŠœã‘ç©´ã‚’å·§ã¿ã«ä½¿ã£ãŸå¼·å¼•ãªæ‰‹æ³•ã§çŸ¥ã‚‰ã‚Œã€ç›¸æ¾¤ã®ã€Œæ±šã‚Œä»•äº‹ã€ã‚’ä¸€æ‰‹ã«å¼•ãå—ã‘ã¦ããŸã€‚å†·å¾¹ã§è¨ˆç®—é«˜ã„æ€§æ ¼ã ãŒã€æœ€è¿‘ã¯ç›¸æ¾¤ã®ç„¡èŒ¶ãªè¦æ±‚ã«è¾Ÿæ˜“ã—ã¦ã„ãŸã€‚å¼è­·å£«ã¨ã—ã¦ã®ãƒ—ãƒ©ã‚¤ãƒ‰ã¯é«˜ãã€é•æ³•è¡Œç‚ºã®è²¬ä»»ã‚’æŠ¼ã—ä»˜ã‘ã‚‰ã‚Œã‚‹ã“ã¨ã ã‘ã¯çµ¶å¯¾ã«è¨±ã›ãªã„ã€‚",
                motive: "ç›¸æ¾¤ã®é•æ³•è¡Œç‚ºã«åŠ æ‹…ã—ã¦ããŸãŒã€æœ€è¿‘ç›¸æ¾¤ãŒã€Œå…¨ã¦ã®è²¬ä»»ã‚’é»’æœ¨ã«æŠ¼ã—ä»˜ã‘ã‚‹ã€è¨ˆç”»ã‚’ç«‹ã¦ã¦ã„ã‚‹ã“ã¨ã‚’çŸ¥ã‚‹ã€‚ã“ã®ã¾ã¾ã§ã¯å¼è­·å£«è³‡æ ¼ã‚’å‰¥å¥ªã•ã‚Œã€åˆ‘å‹™æ‰€è¡Œãã«ãªã‚‹ã€‚",
                arrival: "22:35åˆ°ç€",
                alibi: "22:35åˆ°ç€å¾Œã€ãƒªãƒ“ãƒ³ã‚°ã§å¾…æ©Ÿã€‚23:30-24:00ã®é¢è«‡äºˆå®šã€‚23:00-23:05ã®é–“ã€æ°´é‡ã€ä½è—¤ã€å±±æœ¬ã¨ãƒªãƒ“ãƒ³ã‚°ã§å¾…æ©Ÿã€‚4äººä¸€ç·’ã«ã„ãŸãŸã‚ã€ã‚¢ãƒªãƒã‚¤ã‚ã‚Šã€‚",
                questions: [
                    {
                        q: "23:00ã‹ã‚‰23:05ã®é–“ã€ç”°ä¸­ã•ã‚“ã¯ã©ã“ã«ã„ã¾ã—ãŸã‹?",
                        a: "ç”°ä¸­ã•ã‚“ã¯...23:00éãã«ã„ãªããªã£ã¦ã€23:03é ƒã«æˆ»ã£ã¦ãã¾ã—ãŸã€‚é¡”è‰²ãŒæ‚ªã‹ã£ãŸã§ã™ã­ã€‚",
                        evidence: "æ±ºå®šçš„ãªè¨¼è¨€ã€‚ç”°ä¸­ãŒ23:00-23:03ã®ç´„3åˆ†é–“ä¸åœ¨ã ã£ãŸã“ã¨ã‚’è¨¼è¨€ã€‚çŠ¯è¡Œã«å¿…è¦ãªæ™‚é–“ã¨ä¸€è‡´ã€‚"
                    }
                ]
            }
        ];

        const caseInfo = {
            id: "case",
            name: "äº‹ä»¶æ¦‚è¦",
            role: "åŸºæœ¬æƒ…å ±",
            content: `
                <div class="detail-section">
                    <h3>äº‹ä»¶ã®æ¦‚è¦</h3>
                    <div class="victim-info">
                        <p><strong>è¢«å®³è€…:</strong> ç›¸æ¾¤éš†ä¸€ï¼ˆ38æ­³ï¼‰ITä¼æ¥­ç¤¾é•·</p>
                        <p><strong>æ­»äº¡æ¨å®šæ™‚åˆ»:</strong> åˆå¾Œ11æ™‚00åˆ†ï¼ˆÂ±3åˆ†ä»¥å†…ï¼‰</p>
                        <p><strong>æ­»å› :</strong> é¦–ã‚’çµã‚ã‚‰ã‚ŒãŸã“ã¨ã«ã‚ˆã‚‹çª’æ¯æ­»</p>
                        <p><strong>å‡¶å™¨:</strong> è¢«å®³è€…ãŒèº«ã«ã¤ã‘ã¦ã„ãŸãƒã‚¯ã‚¿ã‚¤</p>
                        <p><strong>ç™ºè¦‹çŠ¶æ³:</strong> 23:05ã«æ›¸æ–ã§æ°´é‡ç¾å’²ãŒç™ºè¦‹</p>
                    </div>

                    <h3>é‡è¦ãªè¨¼æ‹ </h3>
                    <p>ãƒ»çŠ¯è¡Œæ™‚åˆ»ã¯<strong>23:00-23:05ã®5åˆ†é–“</strong>ã«é™å®šã•ã‚Œã‚‹</p>
                    <p>ãƒ»æ°´é‡ãŒ23:05ã«æ›¸æ–ã‚’è¨ªã‚ŒãŸæ™‚ã¯æ—¢ã«æ­»äº¡ã—ã¦ã„ãŸ</p>
                    <p>ãƒ»çŠ¯è¡Œã«ã¯ç´„3åˆ†å¿…è¦ï¼ˆé¦–ã‚’çµã‚ã‚‹+é€ƒèµ°ï¼‰</p>
                    <p>ãƒ»æ›¸æ–ã¸ã®å‡ºå…¥ã‚Šã¯ç„é–¢ãƒ›ãƒ¼ãƒ«ã‹ã‚‰ç›´æ¥å¯èƒ½</p>

                    <h3>ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³</h3>
                    <div class="timeline">
                        <div class="timeline-item"><strong>22:00</strong> - æ°´é‡åˆ°ç€ã€æ›¸æ–ã§é¢è«‡é–‹å§‹</div>
                        <div class="timeline-item"><strong>22:15</strong> - éº»è¡£åˆ°ç€ã€ãƒªãƒ“ãƒ³ã‚°ã§å¾…æ©Ÿ</div>
                        <div class="timeline-item"><strong>22:20</strong> - ç”°ä¸­åˆ°ç€ã€ãƒªãƒ“ãƒ³ã‚°ã§å¾…æ©Ÿ</div>
                        <div class="timeline-item"><strong>22:30</strong> - ä½è—¤åˆ°ç€ã€æ°´é‡ãŒãƒªãƒ“ãƒ³ã‚°ã¸ç§»å‹•</div>
                        <div class="timeline-item"><strong>22:30-23:00</strong> - éº»è¡£ã¨é¢è«‡ï¼ˆæ›¸æ–ï¼‰</div>
                        <div class="timeline-item"><strong>22:35</strong> - é»’æœ¨åˆ°ç€ã€ãƒªãƒ“ãƒ³ã‚°ã§å¾…æ©Ÿ</div>
                        <div class="timeline-item"><strong>22:40</strong> - å±±æœ¬åˆ°ç€ã€ãƒªãƒ“ãƒ³ã‚°ã§å¾…æ©Ÿ</div>
                        <div class="timeline-item"><strong>23:00</strong> - éº»è¡£é€€å®¤ãƒ»å¸°å®…ã€ç›¸æ¾¤ãŒæ›¸æ–ã¸ç§»å‹•</div>
                        <div class="timeline-item" style="color: var(--accent-red);"><strong>23:00-23:05</strong> - <strong>çŠ¯è¡Œç™ºç”Ÿ</strong></div>
                        <div class="timeline-item"><strong>23:05</strong> - æ°´é‡ãŒæ›¸æ–ã‚’è¨ªã‚Œéºä½“ç™ºè¦‹</div>
                    </div>

                    <button class="question-btn" onclick="showFloorPlan()" style="width: 100%; margin-top: 20px;">é–“å–ã‚Šå›³ã‚’ç¢ºèªã™ã‚‹</button>
                </div>
            `
        };

        const floorPlan = {
            id: "floor",
            name: "é–“å–ã‚Šå›³",
            role: "ã‚¹ã‚¤ãƒ¼ãƒˆæ§‹é€ ",
            content: `
                <div class="detail-section">
                    <h3>ã‚¹ã‚¤ãƒ¼ãƒˆãƒ«ãƒ¼ãƒ é–“å–ã‚Šå›³</h3>
                    <div class="floor-plan-container">
                        <div class="floor-plan">
                            <div class="floor-row">
                                <div class="room hallway vertical-room">
                                    <div class="room-name">ã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼</div>
                                </div>
                            </div>
                            <div class="floor-row">
                                <div class="room hallway">
                                    <div class="room-name">ç„é–¢ãƒ›ãƒ¼ãƒ«</div>
                                </div>
                            </div>
                            <div class="floor-row">
                                <div class="room crime-scene">
                                    <div class="room-name">æ›¸æ–</div>
                                    <div class="room-detail">çŠ¯è¡Œç¾å ´</div>
                                </div>
                                <div class="room">
                                    <div class="room-name">ãƒªãƒ“ãƒ³ã‚°</div>
                                    <div class="room-detail">å¾…æ©Ÿå ´æ‰€</div>
                                </div>
                                <div class="room">
                                    <div class="room-name">ãƒãƒ«ã‚³ãƒ‹ãƒ¼</div>
                                </div>
                            </div>
                            <div class="floor-row">
                                <div class="room" style="min-width: 320px;">
                                    <div class="room-name">å¯å®¤</div>
                                </div>
                                <div class="room">
                                    <div class="room-name">æµ´å®¤</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="alibi-box" style="margin-top: 30px;">
                        <h4 style="color: var(--accent-gold); margin-bottom: 10px;">é‡è¦ãƒã‚¤ãƒ³ãƒˆ</h4>
                        <p>ãƒ»ç„é–¢ãƒ›ãƒ¼ãƒ«ã‹ã‚‰æ›¸æ–ã¨ãƒªãƒ“ãƒ³ã‚°ã¸ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½</p>
                        <p>ãƒ»ãƒªãƒ“ãƒ³ã‚°ã‹ã‚‰ç„é–¢ãƒ›ãƒ¼ãƒ«çµŒç”±ã§æ›¸æ–ã¾ã§å¾’æ­©ç´„20ç§’</p>
                        <p>ãƒ»å¾€å¾©ã§ç´„40ç§’ + çŠ¯è¡Œ3åˆ† = åˆè¨ˆç´„4-5åˆ†</p>
                        <p>ãƒ»23:00ã®æ™‚ç‚¹ã§ãƒªãƒ“ãƒ³ã‚°ã«ã¯ç”°ä¸­ã€æ°´é‡ã€ä½è—¤ã€å±±æœ¬ã€é»’æœ¨ã®5äºº</p>
                        <p>ãƒ»ã“ã®ä¸­ã§23:00-23:05ã®é–“ã«ä¸åœ¨ã ã£ãŸã®ã¯ç”°ä¸­ã®ã¿</p>
                    </div>
                </div>
            `
        };

        // ã‚²ãƒ¼ãƒ çŠ¶æ…‹
        let gameState = {
            currentSuspect: "case",
            askedQuestions: {},
            discoveredEvidence: new Set(),
            selectedSuspect: null
        };

        // BGMç®¡ç†
        let currentBGM = null;
        let isMuted = false;

        function initBGM() {
            currentBGM = document.getElementById('defaultBGM');
            currentBGM.volume = 0.5;

            // ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œå¾Œã«å†ç”Ÿ
            document.body.addEventListener('click', function initAudio() {
                if (currentBGM && currentBGM.paused) {
                    currentBGM.play().catch(e => console.log('BGMå†ç”Ÿã‚¨ãƒ©ãƒ¼:', e));
                }
                document.body.removeEventListener('click', initAudio);
            }, { once: true });

            // ãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼
            document.getElementById('volumeSlider').addEventListener('input', function() {
                const volume = this.value / 100;
                if (currentBGM) currentBGM.volume = volume;
                document.getElementById('volumeLabel').textContent = this.value + '%';
            });
        }

        function toggleBGMPanel() {
            const control = document.getElementById('bgmControl');
            control.classList.toggle('collapsed');
            control.classList.toggle('expanded');
        }

        function toggleMute() {
            isMuted = !isMuted;
            if (currentBGM) currentBGM.muted = isMuted;

            const btn = document.getElementById('muteBtn');
            const text = document.getElementById('muteText');

            if (isMuted) {
                btn.classList.add('muted');
                text.textContent = 'ğŸ”‡ OFF';
            } else {
                btn.classList.remove('muted');
                text.textContent = 'ğŸ”Š ON';
            }
        }

        function changeBGM(bgmId, title) {
            if (currentBGM) {
                currentBGM.pause();
                currentBGM.currentTime = 0;
            }

            currentBGM = document.getElementById(bgmId);
            if (currentBGM) {
                currentBGM.volume = document.getElementById('volumeSlider').value / 100;
                currentBGM.muted = isMuted;
                currentBGM.play().catch(e => console.log('BGMå†ç”Ÿã‚¨ãƒ©ãƒ¼:', e));
            }

            document.getElementById('nowPlaying').textContent = title;
        }

        // è¨¼æ‹ ã‚’è¿½åŠ 
        function addEvidence(title, description) {
            if (gameState.discoveredEvidence.has(title)) return;

            gameState.discoveredEvidence.add(title);
            const evidenceList = document.getElementById('evidenceList');
            const evidenceItem = document.createElement('div');
            evidenceItem.className = 'evidence-item new';
            evidenceItem.innerHTML = `
                <div class="evidence-title">${title}</div>
                <div>${description}</div>
            `;
            evidenceList.insertBefore(evidenceItem, evidenceList.firstChild);

            setTimeout(() => evidenceItem.classList.remove('new'), 2000);
        }

        // ã‚²ãƒ¼ãƒ é–‹å§‹
        function startGame() {
            document.getElementById('introScreen').style.display = 'none';
            document.getElementById('gameScreen').style.display = 'block';

            initBGM();
            renderSuspectCards();
            showSuspectDetail("case");
        }

        // å®¹ç–‘è€…ã‚«ãƒ¼ãƒ‰æç”»
        function renderSuspectCards() {
            const grid = document.getElementById('suspectsGrid');

            // äº‹ä»¶æ¦‚è¦ã‚«ãƒ¼ãƒ‰
            const caseCard = document.createElement('div');
            caseCard.className = 'suspect-card info-card';
            caseCard.onclick = () => showSuspectDetail('case');
            caseCard.innerHTML = `
                <div class="suspect-name">${caseInfo.name}</div>
                <div class="suspect-role">${caseInfo.role}</div>
            `;
            grid.appendChild(caseCard);

            // é–“å–ã‚Šå›³ã‚«ãƒ¼ãƒ‰
            const floorCard = document.createElement('div');
            floorCard.className = 'suspect-card info-card';
            floorCard.onclick = () => showSuspectDetail('floor');
            floorCard.innerHTML = `
                <div class="suspect-name">${floorPlan.name}</div>
                <div class="suspect-role">${floorPlan.role}</div>
            `;
            grid.appendChild(floorCard);

            // å®¹ç–‘è€…ã‚«ãƒ¼ãƒ‰
            suspects.forEach(suspect => {
                const card = document.createElement('div');
                card.className = 'suspect-card';
                card.onclick = () => showSuspectDetail(suspect.id);
                card.innerHTML = `
                    <div class="suspect-name">${suspect.name}</div>
                    <div class="suspect-role">${suspect.role}</div>
                `;
                grid.appendChild(card);
            });

            // å‘Šç™ºã‚«ãƒ¼ãƒ‰ï¼ˆèµ¤è‰²ã§å¼·èª¿ï¼‰
            const accusationCard = document.createElement('div');
            accusationCard.className = 'suspect-card accusation-card';
            accusationCard.onclick = () => openAccusationModal();
            accusationCard.innerHTML = `
                <div class="suspect-name">å‘Šç™º</div>
                <div class="suspect-role">çŠ¯äººã‚’æŒ‡å</div>
            `;
            grid.appendChild(accusationCard);
        }

        // å®¹ç–‘è€…è©³ç´°è¡¨ç¤º
        function showSuspectDetail(suspectId) {
            gameState.currentSuspect = suspectId;

            // ã‚«ãƒ¼ãƒ‰é¸æŠçŠ¶æ…‹æ›´æ–°
            document.querySelectorAll('.suspect-card').forEach(card => card.classList.remove('active'));
            event.currentTarget.classList.add('active');

            const mainPanel = document.getElementById('mainPanel');

            if (suspectId === 'case') {
                mainPanel.innerHTML = `<h2 class="panel-title">${caseInfo.name}</h2>${caseInfo.content}`;
                return;
            }

            if (suspectId === 'floor') {
                mainPanel.innerHTML = `<h2 class="panel-title">${floorPlan.name}</h2>${floorPlan.content}`;
                return;
            }

            const suspect = suspects.find(s => s.id === suspectId);

            let questionsHTML = '<div class="detail-section"><h3>å°‹å•</h3>';
            suspect.questions.forEach((q, index) => {
                const questionId = `${suspectId}-${index}`;
                const asked = gameState.askedQuestions[questionId];
                questionsHTML += `
                    <button class="question-btn" onclick="askQuestion('${suspectId}', ${index})" ${asked ? 'disabled' : ''}>
                        ${q.q}
                    </button>
                    <div class="answer-box ${asked ? 'show' : ''}" id="answer-${questionId}">
                        <strong>${suspect.name}:</strong> ${q.a}
                        <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid var(--border-color); color: var(--accent-gold);">
                            <strong>è¨¼æ‹ :</strong> ${q.evidence}
                        </div>
                    </div>
                `;
            });
            questionsHTML += '</div>';

            mainPanel.innerHTML = `
                <div class="suspect-header">
                    <img src="${suspect.image}" alt="${suspect.name}" class="character-portrait">
                    <div class="suspect-header-info">
                        <h2>${suspect.name}</h2>
                        <div class="suspect-header-section">
                            <h3>ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«</h3>
                            <p>${suspect.profile}</p>
                        </div>
                    </div>
                </div>

                <div class="detail-section">
                    <h3>å‹•æ©Ÿ</h3>
                    <div class="alibi-box" style="border-color: var(--accent-red);">
                        ${suspect.motive}
                    </div>
                </div>

                <div class="detail-section">
                    <h3>åˆ°ç€æ™‚åˆ»ã¨ã‚¢ãƒªãƒã‚¤</h3>
                    <div class="alibi-box">
                        <strong>${suspect.arrival}</strong><br>
                        ${suspect.alibi}
                    </div>
                </div>

                ${questionsHTML}
            `;
        }

        // è³ªå•ã™ã‚‹
        function askQuestion(suspectId, questionIndex) {
            const questionId = `${suspectId}-${questionIndex}`;
            const suspect = suspects.find(s => s.id === suspectId);
            const question = suspect.questions[questionIndex];

            gameState.askedQuestions[questionId] = true;

            document.getElementById(`answer-${questionId}`).classList.add('show');
            event.target.disabled = true;

            addEvidence(
                `${suspect.name}ã®è¨¼è¨€`,
                question.evidence
            );
        }

        // é–“å–ã‚Šå›³è¡¨ç¤º
        function showFloorPlan() {
            showSuspectDetail('floor');
            document.querySelectorAll('.suspect-card').forEach((card, index) => {
                card.classList.remove('active');
                if (index === 1) card.classList.add('active');
            });
        }

        // å‘Šç™ºãƒ¢ãƒ¼ãƒ€ãƒ«
        function openAccusationModal() {
            changeBGM('accusationBGM', 'è§£æ±ºã®ãƒ†ãƒ¼ãƒ');

            const modal = document.getElementById('accusationModal');
            const optionsDiv = document.getElementById('suspectOptions');

            optionsDiv.innerHTML = '';
            suspects.forEach(suspect => {
                const option = document.createElement('div');
                option.className = 'suspect-option';
                option.onclick = () => selectSuspectForAccusation(suspect.id);
                option.innerHTML = `
                    <img src="${suspect.image}" alt="${suspect.name}" class="suspect-option-image">
                    <div class="suspect-option-name">${suspect.name}</div>
                    <div class="suspect-option-role">${suspect.role}</div>
                `;
                option.dataset.suspectId = suspect.id;
                optionsDiv.appendChild(option);
            });

            modal.style.display = 'block';
        }

        function closeAccusationModal() {
            document.getElementById('accusationModal').style.display = 'none';
            gameState.selectedSuspect = null;
            changeBGM('defaultBGM', 'æ·±æ€ªãªè¬');
        }

        function selectSuspectForAccusation(suspectId) {
            document.querySelectorAll('.suspect-option').forEach(opt => opt.classList.remove('selected'));
            event.currentTarget.classList.add('selected');
            gameState.selectedSuspect = suspectId;
        }

        function submitAccusation() {
            if (!gameState.selectedSuspect) {
                alert('å®¹ç–‘è€…ã‚’é¸æŠã—ã¦ãã ã•ã„');
                return;
            }

            console.log('submitAccusation - selectedSuspect:', gameState.selectedSuspect);

            // é¸æŠã•ã‚ŒãŸå®¹ç–‘è€…ã‚’ä¿å­˜ã—ã¦ã‹ã‚‰ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
            const selectedSuspectId = gameState.selectedSuspect;
            document.getElementById('accusationModal').style.display = 'none';

            showResult(selectedSuspectId === 'tanaka', selectedSuspectId);
        }

        // çµæœè¡¨ç¤º
        function showResult(isCorrect, selectedSuspectId) {
            console.log('showResult called, isCorrect:', isCorrect, 'selectedSuspectId:', selectedSuspectId);

            // å…¨ç”»é¢ã‚’éè¡¨ç¤º
            const introScreen = document.getElementById('introScreen');
            const gameScreen = document.getElementById('gameScreen');
            const resultScreen = document.getElementById('resultScreen');

            if (introScreen) introScreen.style.display = 'none';
            if (gameScreen) gameScreen.style.display = 'none';

            // çµæœç”»é¢ã‚’è¡¨ç¤º
            if (resultScreen) {
                resultScreen.classList.add('active');
                resultScreen.style.display = 'block';
                console.log('resultScreen display set to block');
            } else {
                console.error('resultScreen not found');
                return;
            }

            const selectedSuspect = suspects.find(s => s.id === selectedSuspectId);
            console.log('selectedSuspect:', selectedSuspect);

            if (!selectedSuspect) {
                console.error('selectedSuspect not found for id:', selectedSuspectId);
                alert('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚');
                return;
            }

            if (isCorrect) {
                console.log('Correct answer - changing to clearBGM');
                changeBGM('clearBGM', 'æ „å…‰ã®ãƒ•ã‚¡ãƒ³ãƒ•ã‚¡ãƒ¼ãƒ¬');

                resultScreen.innerHTML = `
                    <h2 class="result-title success">æ­£è§£!</h2>
                    <div class="explanation">
                        <p>ã‚ãªãŸã¯è¦‹äº‹ã€çœŸçŠ¯äºº<strong>ç”°ä¸­å¥å¤ª</strong>ã‚’çªãæ­¢ã‚ã¾ã—ãŸ!</p>

                        <h3>äº‹ä»¶ã®çœŸç›¸</h3>
                        <p>çŠ¯äººã¯<strong>ç”°ä¸­å¥å¤ª</strong>ã€‚å½¼ã¯ç›¸æ¾¤ã«ä¼šç¤¾è³‡é‡‘æµç”¨ã®ç½ªã‚’æŠ¼ã—ä»˜ã‘ã‚‰ã‚Œãã†ã«ãªã‚Šã€ç›¸æ¾¤ã‚’æ®ºå®³ã—ã¦è¨¼æ‹ éš æ»…ã‚’å›³ã‚Šã¾ã—ãŸã€‚</p>

                        <h3>çŠ¯è¡Œã®è©³ç´°</h3>
                        <div class="timeline">
                            <div class="timeline-item"><strong>22:30-23:00</strong> - ç›¸æ¾¤ã¯éº»è¡£ã¨æ›¸æ–ã§é¢è«‡ä¸­</div>
                            <div class="timeline-item"><strong>23:00</strong> - éº»è¡£ãŒé€€å®¤ã€ç›¸æ¾¤ãŒæ›¸æ–ã«æ®‹ã‚‹</div>
                            <div class="timeline-item"><strong>23:00-23:03</strong> - ç”°ä¸­ãŒãƒªãƒ“ãƒ³ã‚°ã‹ã‚‰æ›¸æ–ã¸ç§»å‹•</div>
                            <div class="timeline-item"><strong>23:00-23:03</strong> - æ›¸æ–ã§ç›¸æ¾¤ã®ãƒã‚¯ã‚¿ã‚¤ã§é¦–ã‚’çµã‚ã¦æ®ºå®³</div>
                            <div class="timeline-item"><strong>23:03</strong> - ç”°ä¸­ãŒãƒªãƒ“ãƒ³ã‚°ã¸æˆ»ã‚‹ï¼ˆé»’æœ¨ãŒç›®æ’ƒï¼‰</div>
                            <div class="timeline-item"><strong>23:05</strong> - æ°´é‡ãŒæ›¸æ–ã‚’è¨ªã‚Œéºä½“ç™ºè¦‹</div>
                        </div>

                        <h3>æ±ºå®šçš„ãªè¨¼æ‹ </h3>
                        <p>ãƒ»<strong>æ°´é‡ã®è¨¼è¨€</strong>: ã€Œç”°ä¸­ã•ã‚“ãŒ23:00éãã«5åˆ†ãã‚‰ã„ã„ãªããªã£ãŸã€</p>
                        <p>ãƒ»<strong>é»’æœ¨ã®è¨¼è¨€</strong>: ã€Œç”°ä¸­ã•ã‚“ã¯23:03é ƒã«æˆ»ã£ã¦ããŸã€‚é¡”è‰²ãŒæ‚ªã‹ã£ãŸã€</p>
                        <p>ãƒ»<strong>ä½è—¤ã€å±±æœ¬ã®è¨¼è¨€</strong>: ç”°ä¸­ã®ä¸åœ¨ã‚’è£ä»˜ã‘</p>
                        <p>ãƒ»<strong>æ™‚é–“çš„æ¡ä»¶</strong>: ãƒªãƒ“ãƒ³ã‚°â†’æ›¸æ–20ç§’ã€çŠ¯è¡Œ3åˆ†ã€æ›¸æ–â†’ãƒªãƒ“ãƒ³ã‚°20ç§’ = ç´„4åˆ†</p>
                        <p>ãƒ»<strong>å‹•æ©Ÿ</strong>: ä¼šç¤¾è³‡é‡‘æµç”¨ã®ç½ªã‚’æŠ¼ã—ä»˜ã‘ã‚‰ã‚Œãã†ã«ãªã£ã¦ã„ãŸ</p>

                        <h3>ä»–ã®å®¹ç–‘è€…ã®ã‚¢ãƒªãƒã‚¤</h3>
                        <p>ãƒ»<strong>æ°´é‡ç¾å’²</strong>: 23:00-23:05ãƒªãƒ“ãƒ³ã‚°ã§é»’æœ¨ã€å±±æœ¬ã€ä½è—¤ã¨å…±ã«å¾…æ©Ÿ</p>
                        <p>ãƒ»<strong>ç›¸æ¾¤éº»è¡£</strong>: 23:01ã«ã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼ã§å¸°å®…ã€ã‚¿ã‚¯ã‚·ãƒ¼è¨˜éŒ²ã§å®Œå…¨ã‚¢ãƒªãƒã‚¤</p>
                        <p>ãƒ»<strong>ä½è—¤å„ªå­</strong>: ãƒªãƒ“ãƒ³ã‚°ã§ä»–ã®3äººã¨å…±ã«å¾…æ©Ÿ</p>
                        <p>ãƒ»<strong>å±±æœ¬å¤§è¼”</strong>: ãƒªãƒ“ãƒ³ã‚°ã§ä»–ã®3äººã¨å…±ã«å¾…æ©Ÿ</p>
                        <p>ãƒ»<strong>é»’æœ¨èª </strong>: ãƒªãƒ“ãƒ³ã‚°ã§ä»–ã®3äººã¨å…±ã«å¾…æ©Ÿã€ç”°ä¸­ã®ä¸åœ¨ã‚’è¨¼è¨€</p>

                        <p style="margin-top: 30px; text-align: center; font-size: 1.2em; color: var(--accent-gold);">
                            ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™! ã‚ãªãŸã¯å„ªç§€ãªæ¢åµã§ã™!
                        </p>
                    </div>
                    <button class="restart-btn" onclick="location.reload()">ã‚‚ã†ä¸€åº¦ãƒ—ãƒ¬ã‚¤ã™ã‚‹</button>
                `;
            } else {
                console.log('Wrong answer - changing to default BGM');
                changeBGM('defaultBGM', 'æ·±æ€ªãªè¬');
                resultScreen.innerHTML = `
                    <h2 class="result-title failure">ä¸æ­£è§£...</h2>
                    <div class="explanation">
                        <p>ã‚ãªãŸã¯<strong>${selectedSuspect.name}</strong>ã‚’å‘Šç™ºã—ã¾ã—ãŸãŒã€ãã‚Œã¯é–“é•ã„ã§ã—ãŸã€‚</p>

                        <h3>ã‚‚ã†ä¸€åº¦èª¿æŸ»ã—ã¦ã¿ã¾ã—ã‚‡ã†</h3>
                        <p>è¨¼æ‹ ã‚„è¨¼è¨€ã‚’ã‚‚ã†ä¸€åº¦ã‚ˆãç¢ºèªã—ã¦ãã ã•ã„ã€‚</p>
                        <p>ç‰¹ã«ä»¥ä¸‹ã®ãƒã‚¤ãƒ³ãƒˆã«æ³¨ç›®ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š</p>
                        <ul style="text-align: left; display: inline-block; margin: 20px 0;">
                            <li>æ­»äº¡æ¨å®šæ™‚åˆ»ã¯23:00ï¼ˆÂ±3åˆ†ï¼‰</li>
                            <li>å„å®¹ç–‘è€…ã®ã‚¢ãƒªãƒã‚¤ã¨è¨¼è¨€ã‚’ç…§åˆã™ã‚‹</li>
                            <li>çŠ¯è¡Œã«å¿…è¦ãªæ™‚é–“ã¨ç§»å‹•æ™‚é–“ã‚’è¨ˆç®—ã™ã‚‹</li>
                            <li>ä»–ã®å®¹ç–‘è€…ã®è¨¼è¨€ã§è£ä»˜ã‘ã‚‰ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã™ã‚‹</li>
                        </ul>

                        <p style="margin-top: 30px; text-align: center; font-size: 1.1em;">
                            è«¦ã‚ãšã«ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼
                        </p>
                    </div>
                    <button class="restart-btn" onclick="location.reload()">ã‚‚ã†ä¸€åº¦ãƒ—ãƒ¬ã‚¤ã™ã‚‹</button>
                `;
            }

            // DOMãŒæ›´æ–°ã•ã‚Œã¦ã‹ã‚‰ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
            console.log('Setting up scroll to result screen');
            setTimeout(() => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
                console.log('Scrolled to top');
            }, 200);
        }

        // ãƒ¢ãƒ¼ãƒ€ãƒ«å¤–ã‚¯ãƒªãƒƒã‚¯ã§é–‰ã˜ã‚‹
        window.onclick = function(event) {
            const modal = document.getElementById('accusationModal');
            if (event.target === modal) {
                closeAccusationModal();
            }
        }
    </script>
</body>
</html>